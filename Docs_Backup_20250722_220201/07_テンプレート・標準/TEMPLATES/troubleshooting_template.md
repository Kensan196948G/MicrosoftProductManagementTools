# [システム/機能名] - トラブルシューティングガイド

**品質レベル**: ⭐⭐⭐⭐⭐ エンタープライズ級  
**対象者**: 全ユーザー対象  
**緊急度対応**: ⚡ 緊急事態対応可能  
**最終更新**: [YYYY-MM-DD]  
**更新者**: [役職/担当者名]  

---

## 🆘 緊急時対応

### 🚨 システム停止・重大障害
**即座に実施**:
1. **障害状況確認**: [確認方法]
2. **緊急連絡**: [緊急連絡先] - 24時間対応
3. **暫定対処**: [暫定対処方法]

### ⚡ 緊急連絡先
- **システム管理者**: [電話番号] / [メール]
- **技術サポート**: [電話番号] / [メール]  
- **エスカレーション**: [管理責任者連絡先]

---

## 🎯 問題の特定

### 症状から問題を特定
以下の症状から該当する問題を特定してください：

| 症状 | 考えられる問題 | 対応セクション |
|------|---------------|----------------|
| **ログインできない** | 認証問題 | [認証・アクセス問題](#認証・アクセス問題) |
| **データが表示されない** | データ取得エラー | [データ・同期問題](#データ・同期問題) |
| **処理が遅い** | パフォーマンス問題 | [パフォーマンス問題](#パフォーマンス問題) |
| **エラーメッセージ表示** | システムエラー | [システムエラー](#システムエラー) |
| **機能が動作しない** | 操作・設定問題 | [操作・設定問題](#操作・設定問題) |

---

## 🔐 認証・アクセス問題

### ❌ ログインできない

#### 症状
- ログイン画面でエラーが表示される
- 認証情報が受け付けられない
- 「アクセス権限がありません」と表示される

#### 診断手順
1. **認証情報確認**
   ```
   ✅ ユーザー名が正しいか確認
   ✅ パスワードが正しいか確認  
   ✅ 大文字・小文字が正しいか確認
   ```

2. **アカウント状態確認**
   ```
   ✅ アカウントがロックされていないか
   ✅ パスワード有効期限が切れていないか
   ✅ アカウントが無効化されていないか
   ```

3. **システム状態確認**
   ```
   ✅ システムが稼働中か確認
   ✅ メンテナンス中でないか確認
   ```

#### 解決方法
1. **パスワードリセット**
   - [パスワードリセット手順]
   - [セルフサービスポータルURL]

2. **管理者へ連絡**
   - アカウントロック解除依頼
   - アクセス権限確認依頼

3. **代替アクセス方法**
   - [代替ログイン方法]
   - [緊急アクセス手順]

### ❌ 権限エラー

#### エラーメッセージ例
```
"Access Denied: Insufficient privileges"
"権限がありません"
"403 Forbidden"
```

#### 解決方法
1. **権限確認**
   - 必要な権限: [権限一覧]
   - 確認方法: [権限確認手順]

2. **権限申請**
   - 申請先: [申請先]
   - 申請フォーム: [リンク]

---

## 💾 データ・同期問題

### ❌ データが表示されない

#### 症状チェックリスト
- [ ] 画面が空白になっている
- [ ] 古いデータが表示されている  
- [ ] 一部のデータのみ表示されない
- [ ] エラーメッセージが表示される

#### 診断手順
1. **ブラウザ確認** (Web版の場合)
   ```bash
   # ブラウザキャッシュクリア
   Ctrl + Shift + Delete (Windows)
   Cmd + Shift + Delete (Mac)
   ```

2. **ネットワーク確認**
   ```bash
   # 接続テスト
   ping [サーバーアドレス]
   nslookup [サーバーアドレス]
   ```

3. **データソース確認**
   - Microsoft 365接続状態確認
   - APIエンドポイント応答確認

#### 解決方法
1. **画面更新**
   - **F5**キーまたは**更新ボタン**をクリック
   - **Ctrl+F5**で強制更新

2. **再ログイン**
   - いったんログアウト
   - 再度ログイン

3. **データ同期実行**
   - [手動同期手順]
   - [同期ボタンの場所]

### ❌ データ同期エラー

#### エラーコード別対応
| エラーコード | 原因 | 対処法 |
|-------------|------|--------|
| `SYNC_001` | 接続タイムアウト | [対処法1] |
| `SYNC_002` | 認証エラー | [対処法2] |
| `SYNC_003` | データ形式エラー | [対処法3] |

---

## 🐌 パフォーマンス問題

### ❌ 処理が遅い・応答しない

#### 症状レベル判定
- **軽微** (5-10秒遅延): [軽微対処]
- **中程度** (10-30秒遅延): [中程度対処]  
- **重大** (30秒以上・無応答): [重大対処]

#### 即効性のある対処法
1. **メモリ・CPU確認**
   ```bash
   # Windowsの場合
   タスクマネージャー (Ctrl+Shift+Esc)
   
   # リソース使用率確認
   - CPU使用率: 80%未満が正常
   - メモリ使用率: 80%未満が正常
   ```

2. **不要なプロセス終了**
   - [終了しても安全なプロセス一覧]
   - [システム重要プロセス一覧]

3. **システム再起動**
   - アプリケーション再起動
   - PC再起動（最終手段）

#### 根本的な改善方法
1. **設定最適化**
   - [パフォーマンス設定項目]
   - [推奨設定値]

2. **データ量調整**
   - 表示期間を短縮
   - フィルター条件を追加

---

## ⚠️ システムエラー

### エラーメッセージ別対応

#### "Internal Server Error (500)"
**原因**: サーバー内部エラー

**対処法**:
1. **待機して再試行** (5-10分後)
2. **システム管理者に連絡**
3. **代替手段の利用** (可能な場合)

#### "Service Unavailable (503)"  
**原因**: サービス一時停止

**対処法**:
1. **システム状況確認**: [システム状況ページ]
2. **定期メンテナンス確認**: [メンテナンス情報ページ]
3. **復旧まで待機**

#### "Bad Request (400)"
**原因**: リクエスト形式エラー

**対処法**:
1. **入力内容確認**
   - 必須項目が入力されているか
   - 文字数制限を超えていないか
   - 不正な文字が含まれていないか

2. **データ形式確認**
   - 日付形式: YYYY-MM-DD
   - 時刻形式: HH:MM:SS
   - メール形式: user@domain.com

### PowerShellエラー対応

#### "Execution Policy Error"
```powershell
# 実行ポリシー確認
Get-ExecutionPolicy

# 実行ポリシー変更（管理者権限）
Set-ExecutionPolicy RemoteSigned -Force
```

#### "Module Not Found"
```powershell
# モジュール確認
Get-Module -ListAvailable

# モジュールインストール
Install-Module -Name [ModuleName] -Force
```

---

## 🔧 操作・設定問題

### ❌ 設定が保存されない

#### チェックリスト
- [ ] 権限が十分か確認
- [ ] 必須項目がすべて入力されているか
- [ ] 文字数制限内か確認
- [ ] 他のユーザーが同時編集していないか

#### 解決手順
1. **設定内容再確認**
2. **一度クリア後再入力**
3. **別ブラウザ/デバイスで試行**

### ❌ 機能ボタンが押せない

#### 考えられる原因
- **権限不足**: [権限確認方法]
- **前提条件未達**: [前提条件一覧]
- **システム制限**: [制限事項確認]
- **ブラウザ問題**: [対応ブラウザ一覧]

---

## 🔍 高度な診断

### ログ確認方法

#### システムログ
```bash
# Windows Event Log
eventvwr.msc

# 確認すべきログ
- Application Log
- System Log  
- Security Log
```

#### アプリケーションログ
```bash
# ログファイル場所
C:\Logs\Microsoft365Tools\
/var/log/m365tools/ (Linux)

# 主要ログファイル
- application.log
- error.log
- authentication.log
```

### ネットワーク診断
```bash
# 基本接続テスト
ping outlook.office.com
nslookup graph.microsoft.com

# ポート確認  
telnet outlook.office.com 443
Test-NetConnection -ComputerName outlook.office.com -Port 443
```

### Microsoft 365接続診断
```powershell
# Graph API接続テスト
Test-MgConnection

# Exchange Online接続テスト  
Test-Connection -ComputerName outlook.office.com

# Teams接続テスト
Test-CsOnlineConnection
```

---

## 📋 情報収集テンプレート

### 問い合わせ時の必要情報

#### 基本情報
- **発生日時**: [YYYY-MM-DD HH:MM]
- **ユーザー**: [ユーザー名/部署]
- **環境**: [OS/ブラウザ/バージョン]
- **操作内容**: [何をしようとしていたか]

#### エラー情報  
- **エラーメッセージ**: [正確な文言]
- **エラーコード**: [コード番号]
- **スクリーンショット**: [添付]

#### 再現性
- **再現頻度**: [毎回/時々/稀]
- **再現手順**: [詳細な手順]
- **正常時との違い**: [以前は正常だったか]

### 情報収集コマンド
```powershell
# システム情報収集
Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, TotalPhysicalMemory

# PowerShellバージョン
$PSVersionTable

# インストール済みモジュール
Get-Module -ListAvailable | Where-Object {$_.Name -like "*Microsoft*"}
```

---

## 🔄 エスカレーション手順

### レベル1: 自己解決
1. **このガイド確認** (5-10分)
2. **基本対処実施** (10-15分)
3. **再試行** (3回まで)

### レベル2: チーム内サポート
- **対象**: 同僚・チームリーダー
- **連絡方法**: [内部連絡先]
- **必要情報**: [基本情報テンプレート]

### レベル3: 技術サポート
- **対象**: システム管理者・IT部門
- **連絡方法**: [技術サポート連絡先]
- **必要情報**: [詳細情報テンプレート]

### レベル4: ベンダーサポート
- **対象**: Microsoft サポート
- **連絡方法**: [ベンダーサポート手順]
- **必要情報**: [診断結果・ログファイル]

---

## 📚 予防・メンテナンス

### 定期メンテナンス

#### 日次チェック項目
- [ ] システム正常起動確認
- [ ] データ同期状況確認  
- [ ] エラーログ確認

#### 週次チェック項目
- [ ] システム更新確認
- [ ] パフォーマンス状況確認
- [ ] バックアップ状況確認

#### 月次チェック項目
- [ ] セキュリティ更新適用
- [ ] 容量・リソース使用状況確認
- [ ] 設定・権限見直し

### 予防策
1. **定期的なブラウザキャッシュクリア**
2. **システム更新の適用**
3. **不要ファイル・データの整理**
4. **パスワードの定期変更**

---

## 📞 サポート連絡先

### 🆘 緊急時（24時間対応）
- **電話**: [緊急電話番号]
- **メール**: [緊急メールアドレス]
- **チャット**: [緊急チャットシステム]

### 💬 一般サポート（営業時間内）
- **電話**: [一般電話番号]
- **メール**: [一般メールアドレス]  
- **チケットシステム**: [チケットシステムURL]

### 📋 サポートレベル別対応時間
| レベル | 対応時間 | 内容 |
|--------|----------|------|
| **緊急** | 1時間以内 | システム停止・重大障害 |
| **高** | 4時間以内 | 業務影響大・セキュリティ問題 |
| **中** | 1営業日以内 | 機能障害・パフォーマンス問題 |
| **低** | 3営業日以内 | 操作質問・改善要望 |

---

## 📝 文書情報

**作成日**: [YYYY-MM-DD]  
**作成者**: [役職/担当者名]  
**最終更新**: [YYYY-MM-DD]  
**更新者**: [役職/担当者名]  
**品質レベル**: ⭐⭐⭐⭐⭐ エンタープライズ級  
**レビュー**: [承認者名] - [承認日]  
**緊急対応検証**: [検証済み] - [検証日]  

### 更新履歴
| 日付 | バージョン | 変更内容 | 変更者 |
|------|------------|----------|--------|
| YYYY-MM-DD | v1.0 | 初版作成 | [担当者] |
| YYYY-MM-DD | v1.1 | 緊急対応手順追加 | [担当者] |

---

**Documentation Architecture Engineer**  
**Microsoft 365管理ツール - トラブルシューティングテンプレート**  
**品質基準**: ⭐⭐⭐⭐⭐ エンタープライズ級