# 🎯 Microsoft製品管理ツール - itmux並列開発環境 導入手順書

## 📋 目次
1. [前提条件](#前提条件)
2. [初期セットアップ](#初期セットアップ)
3. [itmux環境構築](#itmux環境構築)
4. [設定ファイルの配置](#設定ファイルの配置)
5. [動作確認](#動作確認)
6. [トラブルシューティング](#トラブルシューティング)

---

## 🔧 前提条件

### 必要なソフトウェア
- [ ] **Windows 10/11** (64bit)
- [ ] **PowerShell 5.1以上** または **PowerShell Core 7.x**
- [ ] **itmux** (C:\tools\itmux に配置済み)
- [ ] **Node.js** (推奨: v18.x LTS) - オプション
- [ ] **Git for Windows** - オプション

### 権限要件
- [ ] **管理者権限** (初期セットアップ時のみ)
- [ ] **PowerShell実行ポリシー** の変更権限

---

## 🚀 初期セットアップ

### 1. PowerShell実行ポリシーの設定
```powershell
# 管理者権限でPowerShellを開いて実行
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser -Force

# 確認
Get-ExecutionPolicy -Scope CurrentUser
```

### 2. itmux環境セットアップスクリプトの実行
```powershell
# Microsoft製品管理ツールのディレクトリに移動
cd E:\MicrosoftProductManagementTools

# セットアップスクリプトを実行
powershell -File itmux\setup-itmux-environment.ps1
```

**実行結果例:**
```
🎯 ITSM開発環境のitmux統合セットアップを開始します
📁 作業ディレクトリ: C:\workspace\MicrosoftProductManagementTools
🔧 itmux インストール: C:\tools\itmux
📂 ディレクトリ構造を作成中...
✅ 作成: C:\workspace\MicrosoftProductManagementTools\frontend
✅ 作成: C:\workspace\MicrosoftProductManagementTools\backend
✅ 作成: C:\workspace\MicrosoftProductManagementTools\tests
✅ 作成: C:\workspace\MicrosoftProductManagementTools\integration
✅ 作成: C:\workspace\MicrosoftProductManagementTools\scripts
✅ 作成: C:\workspace\MicrosoftProductManagementTools\logs
✅ 作成: C:\workspace\MicrosoftProductManagementTools\docs
✅ 作成: C:\workspace\MicrosoftProductManagementTools\config
✅ 作成: C:\workspace\MicrosoftProductManagementTools\itmux-scripts
🔍 itmux環境を検証中...
✅ itmux.cmd: OK
✅ tmux.exe: OK
✅ mintty.exe: OK
🔧 環境変数を設定中...
✅ PATH環境変数にitmux binディレクトリを追加しました
✅ ITSM開発環境変数を設定しました
🔒 PowerShell実行ポリシーを確認中...
✅ PowerShell実行ポリシー: RemoteSigned
🎉 itmux環境のセットアップが完了しました!
```

---

## 🏗️ itmux環境構築

### 3. 設定ファイルの配置

#### tmux設定ファイルのコピー
```bash
# itmuxを起動
C:\tools\itmux\itmux.cmd

# 設定ファイルをコピー
cp /cygdrive/e/MicrosoftProductManagementTools/itmux/tmux.conf ~/.tmux.conf

# 設定の確認
cat ~/.tmux.conf
```

#### スクリプトファイルのコピー
```bash
# 作業ディレクトリに移動
cd /cygdrive/c/workspace/MicrosoftProductManagementTools

# スクリプトファイルをコピー
cp /cygdrive/e/MicrosoftProductManagementTools/itmux/create-itsm-session.sh .
cp /cygdrive/e/MicrosoftProductManagementTools/itmux/powershell-itmux-manager.sh .

# 実行権限を付与
chmod +x create-itsm-session.sh
chmod +x powershell-itmux-manager.sh
```

### 4. 開発セッションの作成

#### セッション構築スクリプトの実行
```bash
# セッション作成スクリプトを実行
./create-itsm-session.sh
```

**実行結果例:**
```
🎯 ITSM開発セッション構築を開始します
📁 作業ディレクトリ: /cygdrive/c/workspace/MicrosoftProductManagementTools
🔗 セッション名: MicrosoftProductManagementTools
🔍 作業ディレクトリ構造を確認中...
🗑️ 既存のセッションを削除中...
🚀 新しいITSM開発セッションを作成中...
👑 CEO Strategy Terminal を設定中...
👔 Manager Coordination Terminal を設定中...
💻 dev1 Frontend Development を設定中...
🔧 dev2 Backend/DB/API Development を設定中...
🗄️ dev3 Test/QA/Security を設定中...
🧪 dev4 Integration/Validation を設定中...

✅ ITSM開発セッションが正常に作成されました!
🔗 セッション: MicrosoftProductManagementTools
📋 ウィンドウ構成:
  0: CEO-Strategy     (1ペイン)
  1: Manager-Coord    (1ペイン)
  2: dev1-Frontend    (4ペイン)
  3: dev2-Backend     (4ペイン)
  4: dev3-TestQA      (4ペイン)
  5: dev4-Integration (4ペイン)

🎯 接続方法: tmux attach-session -t MicrosoftProductManagementTools
⌨️  操作方法:
  - Ctrl+a + [0-5]: ウィンドウ切り替え
  - Ctrl+a + h/j/k/l: ペイン移動
  - Ctrl+a + |: 垂直分割
  - Ctrl+a + -: 水平分割
  - Ctrl+a + d: セッションデタッチ

🚀 セッションにアタッチしています...
```

---

## 🔍 動作確認

### 5. 基本操作の確認

#### tmuxセッションの確認
```bash
# セッション一覧を表示
tmux list-sessions

# セッションにアタッチ
tmux attach-session -t MicrosoftProductManagementTools

# セッションからデタッチ
# Ctrl+a d
```

#### ウィンドウ・ペイン操作の確認
```bash
# ウィンドウ切り替え
Ctrl+a 0  # CEO-Strategy
Ctrl+a 1  # Manager-Coord
Ctrl+a 2  # dev1-Frontend
Ctrl+a 3  # dev2-Backend
Ctrl+a 4  # dev3-TestQA
Ctrl+a 5  # dev4-Integration

# ペイン移動（dev1-Frontend窓内で）
Ctrl+a h  # 左ペイン
Ctrl+a j  # 下ペイン
Ctrl+a k  # 上ペイン
Ctrl+a l  # 右ペイン
```

### 6. PowerShell統合の確認

#### PowerShell実行マネージャーの初期化
```bash
# 環境初期化
./powershell-itmux-manager.sh init
```

**実行結果例:**
```
🔧 MicrosoftProductManagementTools開発環境を初期化中...
📋 Cygwin環境チェック:
  - Cygwin version: CYGWIN_NT-10.0-19045 DESKTOP-XXX 3.4.10
  - tmux version: tmux 3.3a
  - bash version: 5.2.15(1)-release
🖥️ Windows統合チェック:
  - Windows commands: ✅ Available
  - PowerShell: ✅ Available
📁 マウントポイント:
C: on /cygdrive/c type ntfs (binary,posix=0,user,noumount,auto)
E: on /cygdrive/e type ntfs (binary,posix=0,user,noumount,auto)
📂 作業ディレクトリ:
total 0
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 .
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 ..
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 backend
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 config
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 docs
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 frontend
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 integration
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 logs
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 scripts
drwxr-xr-x 1 User 197121 0 Jul 16 17:00 tests
```

#### 各開発ループの動作確認
```bash
# GUI開発ループ確認
./powershell-itmux-manager.sh gui

# CLI開発ループ確認
./powershell-itmux-manager.sh cli

# 認証テスト確認
./powershell-itmux-manager.sh auth

# 使用可能なコマンド一覧
./powershell-itmux-manager.sh
```

---

## 🛠️ トラブルシューティング

### よくある問題と解決方法

#### 1. itmux起動時のエラー
**問題:** `itmux.cmd` が見つからない
```bash
# 解決方法
# 1. パスの確認
echo $PATH | grep itmux

# 2. itmux.cmdファイルの確認
ls -la C:\\tools\\itmux\\itmux.cmd

# 3. 環境変数の再設定
export PATH="$PATH:/cygdrive/c/tools/itmux/bin"
```

#### 2. PowerShell実行エラー
**問題:** PowerShellスクリプトが実行できない
```powershell
# 解決方法
# 1. 実行ポリシーの確認
Get-ExecutionPolicy -Scope CurrentUser

# 2. 実行ポリシーの変更
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser -Force

# 3. スクリプトブロックの解除
Unblock-File -Path "E:\MicrosoftProductManagementTools\itmux\*.ps1"
```

#### 3. tmuxセッション作成エラー
**問題:** セッションが作成できない
```bash
# 解決方法
# 1. tmuxサーバーの再起動
tmux kill-server
tmux new-session -d -s test

# 2. 設定ファイルの確認
tmux show-options -g

# 3. 設定リロード
tmux source-file ~/.tmux.conf
```

#### 4. 日本語文字化け
**問題:** 日本語が正しく表示されない
```bash
# 解決方法
# 1. 環境変数設定
export LANG=ja_JP.UTF-8
export LC_ALL=ja_JP.UTF-8

# 2. mintty設定
# minttyオプションメニュー → Text → Character set → UTF-8
```

#### 5. パス変換エラー
**問題:** WindowsパスとCygwinパスの変換エラー
```bash
# 解決方法
# 1. cygpathの確認
which cygpath

# 2. 手動パス変換
# Windows → Cygwin
cygpath -u "C:\workspace\MicrosoftProductManagementTools"
# Cygwin → Windows
cygpath -w "/cygdrive/c/workspace/MicrosoftProductManagementTools"

# 3. マウントポイント確認
mount
```

---

## 🎯 導入完了チェックリスト

### ✅ 導入完了確認項目
- [ ] itmux.cmd が正常に起動する
- [ ] tmux新規セッションが作成できる
- [ ] PowerShellスクリプトが実行できる
- [ ] 6つの開発ウィンドウが正常に作成される
- [ ] ペイン分割が正常に動作する
- [ ] ウィンドウ間の切り替えが正常に動作する
- [ ] PowerShell統合マネージャーが動作する
- [ ] 設定ファイルが正常に読み込まれる
- [ ] 日本語表示が正常に動作する
- [ ] セッションのデタッチ・アタッチが正常に動作する

### 🚀 導入後の次のステップ
1. **開発環境のカスタマイズ** - 個人用設定の追加
2. **スクリプトの追加** - プロジェクト固有のスクリプト配置
3. **自動化の設定** - スケジュール実行の設定
4. **チーム共有** - 他の開発者への展開
5. **バックアップ設定** - 設定ファイルのバージョン管理

---

## 📞 サポート情報

### 問題が解決しない場合
1. **ログの確認** - `C:\workspace\MicrosoftProductManagementTools\logs\` 内のログファイルを確認
2. **設定の確認** - 設定ファイルの内容を再度確認
3. **環境の初期化** - セットアップスクリプトの再実行
4. **システム要件の確認** - 前提条件を再確認

### 有用なコマンド
```bash
# 環境情報の確認
uname -a
tmux -V
powershell -Command "Get-Host"

# 設定のリロード
tmux source-file ~/.tmux.conf

# セッションの完全リセット
tmux kill-server
```

---

**🎉 導入完了！Microsoft製品管理ツールのitmux並列開発環境の導入が完了しました。**