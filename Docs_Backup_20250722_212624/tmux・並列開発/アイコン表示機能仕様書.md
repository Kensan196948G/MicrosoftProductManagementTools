# tmux メッセージシステム アイコン表示機能仕様書

## 📋 概要

tmux並列開発環境のメッセージング系統に、視覚的な役職別アイコン表示機能を実装。メッセージの送受信状況を直感的に把握可能にし、チーム内コミュニケーションの効率を大幅に向上させる。

**実装日**: 2025年7月20日  
**対象ファイル**: `send-message-enhanced-hierarchical.sh`  
**バージョン**: v2.1 (アイコン表示対応版)

## 🎯 実装目的

1. **視覚的コミュニケーション**: 役職・専門分野を一目で識別可能
2. **送受信状況の明確化**: 「誰から誰へ」の情報伝達経路を視覚化
3. **緊急メッセージの区別**: 通常配信と緊急配信を視覚的に区別
4. **ログ記録の改善**: アイコン付きログで後続分析を効率化
5. **チーム階層の可視化**: CTO→Manager→Developer階層を直感的に表示

## 🎨 役職別アイコン定義

### 基本役職アイコン

| 役職ID | 役職名 | アイコン | 専門分野 | 責任範囲 |
|--------|--------|----------|----------|----------|
| `cto` | CTO | 👑 | 技術戦略・意思決定 | アーキテクチャ・技術選択・最終責任 |
| `manager` | Manager | 👔 | プロジェクト管理 | 進捗調整・リソース配分・チーム統括 |
| `dev0`/`frontend` | Frontend | 💻 | フロントエンド開発 | React・TypeScript・UI/UX |
| `dev1`/`backend` | Backend | ⚙️ | バックエンド開発 | Python・FastAPI・サーバーサイド |
| `dev2`/`qa` | QA・テスト | 🧪 | 品質保証・テスト | pytest・CI/CD・品質管理 |
| その他 | 汎用 | 📢 | 汎用メッセージ | システム通知・その他 |

### 拡張役職アイコン（8人構成対応）

| 役職ID | 役職名 | アイコン | 専門分野 |
|--------|--------|----------|----------|
| `dev3` | DevOps | 🧪 | インフラ・CI/CD |
| `dev4` | Database | 🚀 | データベース・アーキテクチャ |
| `dev5` | Analytics | 📊 | データ分析・可視化 |

## 📤 メッセージ表示形式

### 通常メッセージ送信

```bash
📤 [送信者アイコン] → [受信者アイコン] 送信中: [受信者名] へメッセージを送信...
✅ [送信者アイコン] → [受信者アイコン] 送信完了: [受信者名] に自動実行されました
```

**実例**:
```bash
📤 👑 → 👔 送信中: Manager へメッセージを送信...
✅ 👑 → 👔 送信完了: Manager に自動実行されました
```

### 緊急メッセージ配信

```bash
⚡ [送信者アイコン] → [受信者アイコン] 即時配信実行: [受信者名]
⚡ [送信者アイコン] → [受信者アイコン] 即時配信完了: [受信者名]
```

**実例**:
```bash
⚡ 👑 → 💻 即時配信実行: dev0
⚡ 👑 → 💻 即時配信完了: dev0
```

### ログ記録形式

```bash
[YYYY-MM-DD HH:MM:SS] [送信者アイコン] → [受信者アイコン] Message sent to [受信者名]: [メッセージ先頭50文字]...
```

**実例**:
```bash
[2025-07-20 15:30:45] 👑 → 👔 Message sent to manager: 【👑 CTO指示】Microsoft Graph API統合テスト実装をお願いします...
```

## 🔧 技術仕様

### 実装関数

#### 1. `get_role_icon()`
```bash
get_role_icon() {
    local role="$1"
    case "$role" in
        "cto")      echo "👑" ;;
        "manager")  echo "👔" ;;
        "dev0"|"frontend") echo "💻" ;;
        "dev1"|"backend")  echo "⚙️" ;;
        "dev2"|"qa")       echo "🧪" ;;
        *)          echo "📢" ;;
    esac
}
```

#### 2. `send_enhanced_message()` (改修版)
- 送信者・受信者のアイコンを取得
- メッセージ送信前後にアイコン付き状況表示
- ログ記録にアイコン情報を追加

#### 3. `instant_broadcast_message()` (改修版)
- 緊急配信時の特別アイコン表示
- 送信者・受信者アイコンを表示

### 階層メッセージングでのアイコン表示

#### CTO全体指示 (`cto-directive`)
```bash
👑 CTO全体指示: [メッセージ内容]
【👑 CTO指示】[メッセージ内容]
```

#### Manager指示 (`manager-task`)
```bash
👔 Manager指示: [メッセージ内容]
【👔 Manager指示】[メッセージ内容]
```

#### 専門分野別指示
```bash
💻 フロントエンド専門タスク: [メッセージ内容]
【💻 Frontend専門】[メッセージ内容]

⚙️ バックエンド専門タスク: [メッセージ内容]  
【⚙️ Backend専門】[メッセージ内容]

🧪 QA・テスト専門タスク: [メッセージ内容]
【🧪 QA専門】[メッセージ内容]
```

## 🚀 自動化機能でのアイコン表示

### 自動タスク分散 (`auto-distribute`)
```bash
🎯 自動分配: [タスク内容] → [アイコン] [担当者名]
【🚀 自動分配タスク】[タスク内容]
```

### 進捗報告収集 (`collect-reports`)
```bash
📊 進捗報告収集開始
【📊 進捗報告要求】現在の作業状況・完了項目・次の予定を簡潔に報告してください。
【👑 CTO】全開発者への進捗報告収集を完了しました。統合レポート作成をお願いします。
```

### チーム活動監視 (`monitor-team-activity`)
```bash
⚠️ [アイコン] [メンバー名]: 最後のアクティビティから[X]分経過
【🚨 緊急ping】[アイコン] 応答確認: 現在の状況を教えてください
```

## 📊 対応機能一覧

| 機能 | アイコン表示対応 | 実装状況 |
|------|------------------|----------|
| 階層メッセージング (cto-directive) | ✅ 完了 | 👑 CTO → 全体指示 |
| Manager指示 (manager-task) | ✅ 完了 | 👔 Manager → Developer配布 |
| 専門分野別タスク (frontend/backend/qa) | ✅ 完了 | 💻⚙️🧪 専門別アイコン |
| 自動タスク分散 (auto-distribute) | ✅ 完了 | 🎯🚀 分散・配布アイコン |
| 進捗報告収集 (collect-reports) | ✅ 完了 | 📊👑 収集・完了アイコン |
| チーム活動監視 (monitor-team-activity) | ✅ 完了 | ⚠️🚨 監視・ping警告 |
| 通常メッセージ送信 | ✅ 完了 | 📤✅ 送信・完了アイコン |
| 緊急メッセージ配信 | ✅ 完了 | ⚡ 即時配信アイコン |
| ログ記録 | ✅ 完了 | 全ログにアイコン情報追加 |

## 🎯 使用例

### 実際のコマンド実行例

```bash
# CTO → 全体指示（アイコン付き）
./send-message-enhanced-hierarchical.sh cto-directive "Microsoft 365 Python移行フェーズ2開始"

# 出力例:
# 👑 CTO全体指示: Microsoft 365 Python移行フェーズ2開始
# 📤 👑 → 👔 送信中: Manager へメッセージを送信...
# ✅ 👑 → 👔 送信完了: Manager に自動実行されました
# 📤 👑 → 💻 送信中: dev0 へメッセージを送信...
# ✅ 👑 → 💻 送信完了: dev0 に自動実行されました
```

```bash
# Manager → Developer配布（アイコン付き）
./send-message-enhanced-hierarchical.sh manager-task "API仕様書レビューをお願いします"

# 出力例:
# 👔 Manager指示: API仕様書レビューをお願いします
# 📤 👔 → 💻 送信中: dev0 へメッセージを送信...
# 📤 👔 → ⚙️ 送信中: dev1 へメッセージを送信...
# 📤 👔 → 🧪 送信中: dev2 へメッセージを送信...
```

```bash
# 自動タスク分散（アイコン付き）
./send-message-enhanced-hierarchical.sh auto-distribute "pytest単体テスト作成"

# 出力例:
# 🎯 自動分配: pytest単体テスト作成 → 🧪 dev2
# 📤 🚀 → 🧪 送信中: dev2 へメッセージを送信...
# ✅ 🚀 → 🧪 送信完了: dev2 に自動実行されました
```

## 🔧 設定・カスタマイズ

### 新規役職の追加

`get_role_icon()` 関数に新しい役職を追加:

```bash
get_role_icon() {
    local role="$1"
    case "$role" in
        "cto")      echo "👑" ;;
        "manager")  echo "👔" ;;
        "dev0"|"frontend") echo "💻" ;;
        "dev1"|"backend")  echo "⚙️" ;;
        "dev2"|"qa")       echo "🧪" ;;
        "dev3"|"devops")   echo "🔧" ;;  # 新規追加例
        "dev4"|"database") echo "🗄️" ;;  # 新規追加例
        *)          echo "📢" ;;
    esac
}
```

### アイコンのカスタマイズ

企業・プロジェクト固有のアイコンに変更可能:

```bash
# 企業テーマ例（金融系）
"cto")      echo "🏦" ;;  # 銀行アイコン
"manager")  echo "💼" ;;  # ビジネス
"frontend") echo "🖥️" ;;  # デスクトップ
"backend")  echo "⚙️" ;;  # ギア（そのまま）
"qa")       echo "🔍" ;;  # 虫眼鏡（検査）
```

## 📈 効果・メリット

### 1. 視覚的コミュニケーション向上
- 役職・専門分野を瞬時に識別
- メッセージの重要度・緊急度を視覚的に判断
- チーム階層の理解促進

### 2. 運用効率の向上
- ログ分析の効率化（アイコンによる速読）
- メッセージ経路の追跡容易化
- 緊急対応時の迅速な状況把握

### 3. チーム連携強化
- 各メンバーの役割・責任の明確化
- プロジェクト進行状況の可視化
- 階層的コミュニケーションの促進

### 4. 学習コスト削減
- 直感的なインターフェース
- 新メンバーの役職理解促進
- 操作ミスの削減

## 🔄 今後の拡張計画

### Phase 2 計画
- **カラーコード対応**: tmuxステータスバーでの色分け表示
- **通知音対応**: 役職別の通知音設定
- **アイコン統計**: 送受信頻度の役職別分析

### Phase 3 計画
- **Web UI連携**: HTML dashboard でのアイコン表示
- **Slack/Teams連携**: 外部チャットツールでのアイコン同期
- **AI分析**: アイコン付きログによる自動パフォーマンス分析

## 📝 変更履歴

| 日付 | バージョン | 変更内容 |
|------|------------|----------|
| 2025-07-20 | v2.1 | アイコン表示機能の初回実装 |
| 2025-07-20 | v2.1.1 | ドキュメント作成・仕様書整備 |

---

**📄 関連ドキュメント**:
- `tmux/README.md` - メインドキュメント（アイコン機能セクション追加済み）
- `tmux/Docs/README_new.md` - 新システムドキュメント（v4.1追記済み）
- `send-message-enhanced-hierarchical.sh` - 実装ファイル

**🔗 参照先**:
- tmux並列開発環境全体仕様
- Microsoft 365 Python移行プロジェクト仕様
- チーム階層管理システム仕様