# ğŸ”§ Microsoft 365çµ±åˆç®¡ç†ãƒ„ãƒ¼ãƒ« ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

GUI/CLIä¸¡å¯¾å¿œç‰ˆã®å•é¡Œè§£æ±ºã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ç›®æ¬¡

1. [ä¸€èˆ¬çš„ãªå•é¡Œ](#ä¸€èˆ¬çš„ãªå•é¡Œ)
2. [PowerShellé–¢é€£å•é¡Œ](#powershellé–¢é€£å•é¡Œ)
3. [èªè¨¼é–¢é€£å•é¡Œ](#èªè¨¼é–¢é€£å•é¡Œ)
4. [GUIé–¢é€£å•é¡Œ](#guié–¢é€£å•é¡Œ)
5. [CLIé–¢é€£å•é¡Œ](#clié–¢é€£å•é¡Œ)
6. [ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå•é¡Œ](#ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå•é¡Œ)
7. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ)
8. [ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–¢é€£å•é¡Œ](#ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–¢é€£å•é¡Œ)
9. [ãƒ­ã‚°ãƒ»è¨ºæ–­](#ãƒ­ã‚°è¨ºæ–­)
10. [ç·Šæ€¥æ™‚å¯¾å¿œ](#ç·Šæ€¥æ™‚å¯¾å¿œ)

## âš ï¸ ä¸€èˆ¬çš„ãªå•é¡Œ

### å•é¡Œ: ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã§ããªã„

#### ç—‡çŠ¶
```
.\run_launcher.ps1 : ãƒ•ã‚¡ã‚¤ãƒ« .\run_launcher.ps1 ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡ŒãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹ãŸã‚...
```

#### åŸå› 
- PowerShellå®Ÿè¡Œãƒãƒªã‚·ãƒ¼ãŒåˆ¶é™ã•ã‚Œã¦ã„ã‚‹

#### è§£æ±ºç­–
```powershell
# ç¾åœ¨ã®å®Ÿè¡Œãƒãƒªã‚·ãƒ¼ç¢ºèª
Get-ExecutionPolicy

# å®Ÿè¡Œãƒãƒªã‚·ãƒ¼å¤‰æ›´ï¼ˆç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser

# ã¾ãŸã¯ä¸€æ™‚çš„ãªå®Ÿè¡Œ
powershell.exe -ExecutionPolicy Bypass -File .\run_launcher.ps1
```

### å•é¡Œ: ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹

#### ç—‡çŠ¶
```
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è­¦å‘Š: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰å–å¾—ã•ã‚Œã€
ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```

#### è§£æ±ºç­–
```powershell
# ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ–ãƒ­ãƒƒã‚¯è§£é™¤
Unblock-File -Path .\run_launcher.ps1

# å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ–ãƒ­ãƒƒã‚¯è§£é™¤
Get-ChildItem -Recurse | Unblock-File
```

### å•é¡Œ: æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã™ã‚‹

#### ç—‡çŠ¶
- æ—¥æœ¬èªãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„
- æ–‡å­—ãŒ?ã‚„ãƒœãƒƒã‚¯ã‚¹æ–‡å­—ã«ãªã‚‹

#### è§£æ±ºç­–
```powershell
# ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨­å®š
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
$PSDefaultParameterValues['Out-File:Encoding'] = 'utf8'

# ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°è¨­å®š
$env:POWERSHELL_TELEMETRY_OPTOUT = 1
```

## ğŸ”§ PowerShellé–¢é€£å•é¡Œ

### å•é¡Œ: PowerShell 7.5.1ãŒè¦‹ã¤ã‹ã‚‰ãªã„

#### ç—‡çŠ¶
```
PowerShell 7.5.1ä»¥ä¸ŠãŒå¿…è¦ã§ã™
ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 5.1.19041.1023
```

#### è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰
```powershell
# PowerShell 7ã®ç¢ºèª
Get-Command pwsh -ErrorAction SilentlyContinue

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
if (Get-Command pwsh -ErrorAction SilentlyContinue) {
    & pwsh -Command '$PSVersionTable.PSVersion'
}

# ãƒ‘ã‚¹ç¢ºèª
$env:PATH -split ';' | Where-Object { $_ -like "*PowerShell*" }
```

#### è§£æ±ºç­–
```powershell
# 1. è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
.\Download-PowerShell751.ps1

# 2. æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
$msiPath = "Installers\PowerShell-7.5.1-win-x64.msi"
Start-Process msiexec.exe -ArgumentList "/i `"$msiPath`" /qn" -Wait -Verb RunAs

# 3. ç’°å¢ƒå¤‰æ•°æ›´æ–°
$env:PATH = [System.Environment]::GetEnvironmentVariable("PATH", "Machine")
```

### å•é¡Œ: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒèª­ã¿è¾¼ã‚ãªã„

#### ç—‡çŠ¶
```
Import-Module : æŒ‡å®šã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« 'Microsoft.Graph' ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã›ã‚“ã§ã—ãŸ
```

#### è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰
```powershell
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª
Get-Module -ListAvailable | Where-Object Name -like "*Graph*"
Get-Module -ListAvailable | Where-Object Name -like "*Exchange*"

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‘ã‚¹ç¢ºèª
$env:PSModulePath -split ';'
```

#### è§£æ±ºç­–
```powershell
# å¿…è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
Install-Module Microsoft.Graph -Force -AllowClobber
Install-Module ExchangeOnlineManagement -Force -AllowClobber

# ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ãªå ´åˆ
Start-Process PowerShell -Verb RunAs -ArgumentList "-Command Install-Module Microsoft.Graph -Force"
```

### å•é¡Œ: PowerShellç‰ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç«¶åˆ

#### ç—‡çŠ¶
- Windows PowerShell (5.1) ã¨PowerShell (7.x) ã®æ··åœ¨å•é¡Œ
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæ­£ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å®Ÿè¡Œã•ã‚Œãªã„

#### è§£æ±ºç­–
```powershell
# æ˜ç¤ºçš„ãªPowerShellãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š
pwsh.exe -File .\run_launcher.ps1  # PowerShell 7.x
powershell.exe -File .\run_launcher.ps1  # Windows PowerShell 5.1

# æ¨å¥¨: ãƒ©ãƒ³ãƒãƒ£ãƒ¼ä½¿ç”¨
.\run_launcher.ps1  # è‡ªå‹•ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
```

## ğŸ” èªè¨¼é–¢é€£å•é¡Œ

### å•é¡Œ: Microsoft Graphèªè¨¼ã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
Connect-MgGraph : AADSTS70002: Error validating credentials. 
AADSTS50012: Invalid client secret is provided.
```

#### è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰
```powershell
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
Test-Path "Config\appsettings.json"
$config = Get-Content "Config\appsettings.json" | ConvertFrom-Json
Write-Host "TenantId: $($config.EntraID.TenantId)"
Write-Host "ClientId: $($config.EntraID.ClientId)"

# èªè¨¼ãƒ†ã‚¹ãƒˆ
.\test-auth-simple.ps1
```

#### è§£æ±ºç­–

##### 1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ›´æ–°
```powershell
# Azure ãƒãƒ¼ã‚¿ãƒ«ã§æ–°ã—ã„ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç”Ÿæˆ
# Config\appsettings.json ã§æ›´æ–°
notepad "Config\appsettings.json"
```

##### 2. è¨¼æ˜æ›¸ç¢ºèª
```powershell
# è¨¼æ˜æ›¸å­˜åœ¨ç¢ºèª
$certPath = "Certificates\mycert.pfx"
Test-Path $certPath

# è¨¼æ˜æ›¸æƒ…å ±ç¢ºèª
$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2($certPath)
Write-Host "Subject: $($cert.Subject)"
Write-Host "Thumbprint: $($cert.Thumbprint)"
Write-Host "NotAfter: $($cert.NotAfter)"
```

##### 3. APIæ¨©é™ç¢ºèª
```
Azure ãƒãƒ¼ã‚¿ãƒ« > Azure Active Directory > ã‚¢ãƒ—ãƒªã®ç™»éŒ² > APIæ¨©é™
å¿…è¦ãªæ¨©é™:
- Microsoft Graph > Application permissions
  - User.Read.All
  - Group.Read.All
  - Directory.Read.All
  - Reports.Read.All
```

### å•é¡Œ: Exchange Onlineæ¥ç¶šã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
Connect-ExchangeOnline : Unable to connect to Exchange Online
```

#### è§£æ±ºç­–
```powershell
# Exchange Onlineæ¥ç¶šãƒ†ã‚¹ãƒˆ
try {
    Connect-ExchangeOnline -AppId $config.ExchangeOnline.AppId `
        -CertificateThumbprint $config.ExchangeOnline.CertificateThumbprint `
        -Organization $config.ExchangeOnline.Organization
    
    Get-Mailbox -ResultSize 1
    Write-Host "Exchange Onlineæ¥ç¶šæˆåŠŸ" -ForegroundColor Green
}
catch {
    Write-Host "Exchange Onlineæ¥ç¶šã‚¨ãƒ©ãƒ¼: $($_.Exception.Message)" -ForegroundColor Red
}
```

### å•é¡Œ: è¨¼æ˜æ›¸ãŒæœŸé™åˆ‡ã‚Œ

#### ç—‡çŠ¶
```
Certificate has expired or is not yet valid
```

#### è¨ºæ–­ãƒ»è§£æ±ºç­–
```powershell
# è¨¼æ˜æ›¸æœ‰åŠ¹æœŸé™ç¢ºèª
$certPath = "Certificates\mycert.pfx"
$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2($certPath)

if ($cert.NotAfter -lt (Get-Date)) {
    Write-Host "è¨¼æ˜æ›¸ãŒæœŸé™åˆ‡ã‚Œã§ã™: $($cert.NotAfter)" -ForegroundColor Red
    
    # æ–°ã—ã„è¨¼æ˜æ›¸ç”Ÿæˆ
    .\Scripts\Common\Create-ExchangeOnlineCertificate.ps1
} else {
    Write-Host "è¨¼æ˜æ›¸ã¯æœ‰åŠ¹ã§ã™: $($cert.NotAfter)" -ForegroundColor Green
}
```

## ğŸ–¼ï¸ GUIé–¢é€£å•é¡Œ

### å•é¡Œ: GUIã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒè¡¨ç¤ºã•ã‚Œãªã„

#### ç—‡çŠ¶
- GUIèµ·å‹•ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒè¡¨ç¤ºã•ã‚Œãªã„
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—

#### è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰
```powershell
# PowerShell 7ç¢ºèª
$PSVersionTable.PSVersion -ge [Version]"7.0.0"

# Windows Forms ã‚¢ã‚»ãƒ³ãƒ–ãƒªç¢ºèª
try {
    Add-Type -AssemblyName System.Windows.Forms
    Write-Host "Windows Formsåˆ©ç”¨å¯èƒ½" -ForegroundColor Green
} catch {
    Write-Host "Windows Formsåˆ©ç”¨ä¸å¯: $($_.Exception.Message)" -ForegroundColor Red
}

# .NET Frameworkç¢ºèª
Get-ItemProperty "HKLM:SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full\" -Name Release
```

#### è§£æ±ºç­–
```powershell
# 1. PowerShell 7ã§å®Ÿè¡Œ
pwsh.exe -File .\Apps\GuiApp.ps1

# 2. .NET Frameworkæ›´æ–°
# Windows Update ã¾ãŸã¯æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

# 3. ãƒ‡ãƒãƒƒã‚°å®Ÿè¡Œ
pwsh.exe -File .\Apps\GuiApp.ps1 -Debug
```

### å•é¡Œ: GUIæ“ä½œã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ

#### ç—‡çŠ¶
- ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒåœæ­¢
- å‡¦ç†ä¸­ã«ãƒãƒ³ã‚°ã‚¢ãƒƒãƒ—

#### è§£æ±ºç­–
```powershell
# ãƒ­ã‚°å‡ºåŠ›æœ‰åŠ¹åŒ–
$env:GUI_DEBUG = "true"
pwsh.exe -File .\Apps\GuiApp.ps1

# ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
Get-Content "Logs\gui_app.log" -Tail 20
```

### å•é¡Œ: ç”»é¢è¡¨ç¤ºãŒä¹±ã‚Œã‚‹

#### ç—‡çŠ¶
- æ–‡å­—ã‚„ãƒœã‚¿ãƒ³ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„
- ç”»é¢ã‚µã‚¤ã‚ºãŒé©åˆ‡ã§ãªã„

#### è§£æ±ºç­–
```powershell
# DPIè¨­å®šç¢ºèªãƒ»èª¿æ•´
# Config\launcher-config.json ç·¨é›†
{
  "GuiSettings": {
    "WindowSize": {
      "Width": 1024,
      "Height": 768
    },
    "DpiAware": true
  }
}
```

## ğŸ’» CLIé–¢é€£å•é¡Œ

### å•é¡Œ: CLIãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„

#### ç—‡çŠ¶
- ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ãŒæ–‡å­—åŒ–ã‘
- é¸æŠæ“ä½œãŒã§ããªã„

#### è§£æ±ºç­–
```powershell
# ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç¢ºèªãƒ»è¨­å®š
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
[Console]::InputEncoding = [System.Text.Encoding]::UTF8

# ã‚¿ãƒ¼ãƒŸãƒŠãƒ«è¨­å®šç¢ºèª
$Host.UI.RawUI.WindowTitle = "Microsoft 365ç®¡ç†ãƒ„ãƒ¼ãƒ«"
```

### å•é¡Œ: ãƒãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§å‡¦ç†ãŒåœæ­¢ã™ã‚‹

#### ç—‡çŠ¶
```powershell
.\Apps\CliApp.ps1 -Action daily -Batch
# å‡¦ç†ãŒé€”ä¸­ã§åœæ­¢ã™ã‚‹
```

#### è¨ºæ–­ãƒ»è§£æ±ºç­–
```powershell
# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ä¸Šã’ã¦è©³ç´°ç¢ºèª
.\Apps\CliApp.ps1 -Action daily -Batch -LogLevel Debug

# ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šç¢ºèª
# Config\launcher-config.json
{
  "Performance": {
    "TimeoutMinutes": 60
  }
}
```

### å•é¡Œ: ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ãŒèªè­˜ã•ã‚Œãªã„

#### è§£æ±ºç­–
```powershell
# æ­£ã—ã„å¼•æ•°å½¢å¼ç¢ºèª
.\Apps\CliApp.ps1 -Action help

# ã‚¯ã‚©ãƒ¼ãƒˆä½¿ç”¨
.\Apps\CliApp.ps1 -Action "daily" -ConfigPath "C:\path\to\config.json"
```

## ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå•é¡Œ

### å•é¡Œ: ãƒ¬ãƒãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œãªã„

#### ç—‡çŠ¶
- ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œãªã„
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

#### è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰
```powershell
# ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç¢ºèª
Test-Path "Reports"
Get-ChildItem "Reports" -Recurse | Measure-Object

# æ¨©é™ç¢ºèª
$acl = Get-Acl "Reports"
$acl.AccessToString

# ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç¢ºèª
Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, FreeSpace
```

#### è§£æ±ºç­–
```powershell
# 1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
New-Item -Path "Reports" -ItemType Directory -Force

# 2. æ¨©é™è¨­å®š
$acl = Get-Acl "Reports"
$permission = $env:USERNAME, "FullControl", "Allow"
$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission
$acl.SetAccessRule($accessRule)
Set-Acl "Reports" $acl

# 3. ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
.\Apps\CliApp.ps1 -Action daily -Batch -LogLevel Debug
```

### å•é¡Œ: HTMLãƒ¬ãƒãƒ¼ãƒˆãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„

#### ç—‡çŠ¶
- HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¯ç”Ÿæˆã•ã‚Œã‚‹ãŒã€å†…å®¹ãŒç©ºç™½
- ã‚¹ã‚¿ã‚¤ãƒ«ãŒé©ç”¨ã•ã‚Œãªã„

#### è§£æ±ºç­–
```powershell
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
Test-Path "Templates\ReportTemplate.html"

# æ‰‹å‹•ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ†ã‚¹ãƒˆ
$testData = @{
    Title = "ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ"
    Content = "ãƒ†ã‚¹ãƒˆå†…å®¹"
    GeneratedDate = Get-Date
}

$template = Get-Content "Templates\ReportTemplate.html" -Raw
$output = $template -replace "{{Title}}", $testData.Title
$output | Out-File "test-report.html" -Encoding UTF8
```

### å•é¡Œ: CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒæ–‡å­—åŒ–ã‘ã™ã‚‹

#### è§£æ±ºç­–
```powershell
# UTF-8 BOMä»˜ãã§å‡ºåŠ›
$data | Export-Csv "report.csv" -Encoding UTF8 -NoTypeInformation

# ã¾ãŸã¯æ˜ç¤ºçš„ã«BOMè¿½åŠ 
$utf8 = New-Object System.Text.UTF8Encoding($true)
$data | ConvertTo-Csv | Out-File "report.csv" -Encoding UTF8
```

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ

### å•é¡Œ: å‡¦ç†ãŒéå¸¸ã«é…ã„

#### ç—‡çŠ¶
- ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã«ç•°å¸¸ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼ˆ30åˆ†ä»¥ä¸Šï¼‰
- GUIã®å¿œç­”ãŒé…ã„

#### è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰
```powershell
# ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç¢ºèª
Get-Process PowerShell | Select-Object CPU, WorkingSet, VirtualMemorySize
Get-Counter "\Processor(_Total)\% Processor Time"
Get-Counter "\Memory\Available MBytes"

# ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é…å»¶ç¢ºèª
Test-NetConnection graph.microsoft.com -Port 443
Measure-Command { Invoke-RestMethod "https://graph.microsoft.com/v1.0/me" }
```

#### è§£æ±ºç­–
```powershell
# 1. ä¸¦è¡Œå‡¦ç†æ•°èª¿æ•´
# Config\launcher-config.json
{
  "Performance": {
    "MaxConcurrentTasks": 3,
    "TimeoutMinutes": 30
  }
}

# 2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹åŒ–
{
  "Performance": {
    "CacheExpirationMinutes": 60,
    "EnableCaching": true
  }
}

# 3. ãƒãƒƒãƒã‚µã‚¤ã‚ºèª¿æ•´
$users = Get-MgUser -All -PageSize 100  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1000
```

### å•é¡Œ: ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
OutOfMemoryException: ãƒ¡ãƒ¢ãƒªä¸è¶³ã®ãŸã‚ã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã›ã‚“
```

#### è§£æ±ºç­–
```powershell
# 1. ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å¼·åˆ¶å®Ÿè¡Œ
[System.GC]::Collect()
[System.GC]::WaitForPendingFinalizers()

# 2. ãƒ¡ãƒ¢ãƒªåˆ¶é™è¨­å®š
# Config\launcher-config.json
{
  "Performance": {
    "MemoryManagement": {
      "MaxMemoryUsageMB": 2048,
      "GarbageCollectionLevel": 2
    }
  }
}

# 3. åˆ†å‰²å‡¦ç†
$users = Get-MgUser -All
$batches = for ($i = 0; $i -lt $users.Count; $i += 100) {
    $users[$i..($i + 99)]
}
```

## ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–¢é€£å•é¡Œ

### å•é¡Œ: Microsoft 365æ¥ç¶šã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
Invoke-RestMethod : åå‰è§£æ±ºã«å¤±æ•—ã—ã¾ã—ãŸ: 'graph.microsoft.com'
```

#### è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰
```powershell
# DNSè§£æ±ºç¢ºèª
Resolve-DnsName graph.microsoft.com
Resolve-DnsName login.microsoftonline.com

# æ¥ç¶šç¢ºèª
Test-NetConnection graph.microsoft.com -Port 443
Test-NetConnection outlook.office365.com -Port 443

# ãƒ—ãƒ­ã‚­ã‚·è¨­å®šç¢ºèª
netsh winhttp show proxy
```

#### è§£æ±ºç­–
```powershell
# 1. DNSè¨­å®šç¢ºèª
# 8.8.8.8 ã‚„ 1.1.1.1 ãªã©ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯DNSä½¿ç”¨

# 2. ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
$proxy = New-Object System.Net.WebProxy("http://proxy.company.com:8080")
$proxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials
[System.Net.WebRequest]::DefaultWebProxy = $proxy

# 3. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ä¾‹å¤–è¿½åŠ 
New-NetFirewallRule -DisplayName "Microsoft 365 ç®¡ç†ãƒ„ãƒ¼ãƒ«" -Direction Outbound -Protocol TCP -RemotePort 443 -Action Allow
```

### å•é¡Œ: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼

#### ç—‡çŠ¶
```
The operation has timed out.
```

#### è§£æ±ºç­–
```powershell
# ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå€¤å¢—åŠ 
# Config\launcher-config.json
{
  "Performance": {
    "TimeoutMinutes": 60,
    "RetryAttempts": 5,
    "RetryDelaySeconds": 10
  }
}

# PowerShellå´è¨­å®š
$PSDefaultParameterValues['Invoke-RestMethod:TimeoutSec'] = 300
```

## ğŸ“‹ ãƒ­ã‚°ãƒ»è¨ºæ–­

### è¨ºæ–­æƒ…å ±åé›†

#### åŒ…æ‹¬çš„ã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­
```powershell
# system-diagnostics.ps1
$diagnostics = @{
    PowerShellVersion = $PSVersionTable.PSVersion
    OSVersion = [Environment]::OSVersion
    DotNetVersion = [Environment]::Version
    ExecutionPolicy = Get-ExecutionPolicy
    Modules = Get-Module -ListAvailable | Where-Object Name -like "*Graph*" -or Name -like "*Exchange*"
    Network = Test-NetConnection graph.microsoft.com -Port 443
    DiskSpace = Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, FreeSpace
    Memory = Get-WmiObject -Class Win32_ComputerSystem | Select-Object TotalPhysicalMemory
}

$diagnostics | ConvertTo-Json | Out-File "SystemDiagnostics-$(Get-Date -Format 'yyyyMMddHHmmss').json"
```

### ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª

#### ä¸»è¦ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
```powershell
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°
Get-Content "Logs\cli_app.log" -Tail 50

# ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°
Get-Content "Logs\system.log" -Tail 50

# ç®¡ç†ãƒ„ãƒ¼ãƒ«ãƒ­ã‚°
$latestLog = Get-ChildItem "Logs" -Filter "Management_*.log" | Sort-Object LastWriteTime -Descending | Select-Object -First 1
Get-Content $latestLog.FullName -Tail 50

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿æŠ½å‡º
Get-Content "Logs\*.log" | Where-Object { $_ -match "\[Error\]" } | Select-Object -Last 20
```

#### ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°æœ‰åŠ¹åŒ–
```powershell
# è©³ç´°ãƒ­ã‚°å‡ºåŠ›
$env:DEBUG_MODE = "true"
$env:LOG_LEVEL = "Debug"

# ã¾ãŸã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
{
  "Logging": {
    "LogLevel": "Debug",
    "EnablePerformanceLog": true
  }
}
```

## ğŸš¨ ç·Šæ€¥æ™‚å¯¾å¿œ

### å®Œå…¨ãƒªã‚»ãƒƒãƒˆæ‰‹é †

#### 1. è¨­å®šãƒªã‚»ãƒƒãƒˆ
```powershell
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
Copy-Item "Config\appsettings.json" "Config\appsettings.json.emergency.backup"

# åˆæœŸè¨­å®šå¾©å…ƒ
if (Test-Path "Config\appsettings.json.backup.*") {
    $latestBackup = Get-ChildItem "Config\appsettings.json.backup.*" | Sort-Object LastWriteTime -Descending | Select-Object -First 1
    Copy-Item $latestBackup.FullName "Config\appsettings.json"
}
```

#### 2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
```powershell
# PowerShellãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
Remove-Module Microsoft.Graph* -Force -ErrorAction SilentlyContinue
Remove-Module ExchangeOnlineManagement -Force -ErrorAction SilentlyContinue

# ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
Remove-Item "$env:TEMP\Microsoft365Tools*" -Recurse -Force -ErrorAction SilentlyContinue
```

#### 3. å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```powershell
# PowerShell 7.5.1å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
$msiPath = "Installers\PowerShell-7.5.1-win-x64.msi"
Start-Process msiexec.exe -ArgumentList "/i `"$msiPath`" /qn" -Wait -Verb RunAs

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pwsh.exe -Command "Install-Module Microsoft.Graph -Force; Install-Module ExchangeOnlineManagement -Force"
```

### ç·Šæ€¥é€£çµ¡å…ˆ

#### å†…éƒ¨ã‚µãƒãƒ¼ãƒˆ
```
Level 1: IT ãƒ˜ãƒ«ãƒ—ãƒ‡ã‚¹ã‚¯
- é›»è©±: å†…ç·š1234
- ãƒ¡ãƒ¼ãƒ«: helpdesk@company.com
- å¯¾å¿œæ™‚é–“: 9:00-18:00 (å¹³æ—¥)

Level 2: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…
- é›»è©±: å†…ç·š5678
- ãƒ¡ãƒ¼ãƒ«: sysadmin@company.com
- å¯¾å¿œæ™‚é–“: 24æ™‚é–“ (ç·Šæ€¥æ™‚)
```

#### ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †
1. **Level 1**: åŸºæœ¬çš„ãªå•é¡Œï¼ˆè¨­å®šã€æ“ä½œæ–¹æ³•ï¼‰
2. **Level 2**: æŠ€è¡“çš„ãªå•é¡Œï¼ˆèªè¨¼ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰
3. **Level 3**: é‡å¤§ãªéšœå®³ï¼ˆã‚·ã‚¹ãƒ†ãƒ åœæ­¢ã€ãƒ‡ãƒ¼ã‚¿æå¤±ï¼‰

### ãƒ‡ãƒ¼ã‚¿å¾©æ—§

#### ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿å¾©æ—§
```powershell
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒ
$backupPath = "\\backup-server\Microsoft365Tools\Reports"
$localPath = "Reports"

if (Test-Path $backupPath) {
    Copy-Item "$backupPath\*" -Destination $localPath -Recurse -Force
}

# SharePointã‹ã‚‰ã®å¾©å…ƒ
Connect-PnPOnline -Url "https://company.sharepoint.com/sites/reports"
Get-PnPFile -Url "Microsoft365Reports" -AsFile | Copy-Item -Destination $localPath
```

#### è¨­å®šå¾©æ—§
```powershell
# æ—¢çŸ¥ã®è‰¯å¥½ãªè¨­å®šã«å¾©å…ƒ
$goldenConfig = @"
{
  "EntraID": {
    "TenantId": "your-tenant-id",
    "ClientId": "your-client-id",
    "CertificateThumbprint": "your-cert-thumbprint"
  }
}
"@

$goldenConfig | Out-File "Config\appsettings.json" -Encoding UTF8
```

---

**ğŸ“ æŠ€è¡“ã‚µãƒãƒ¼ãƒˆ**: ä¸Šè¨˜ã®è§£æ±ºç­–ã§å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã¾ãŸã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ‹…å½“è€…ã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚è¨ºæ–­æƒ…å ±ã¨ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã—ã¦ã”é€£çµ¡ãã ã•ã„ã€‚