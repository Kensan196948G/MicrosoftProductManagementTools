# ğŸ¢ Microsoft 365çµ±åˆç®¡ç†ãƒ„ãƒ¼ãƒ« ä¼æ¥­å±•é–‹ã‚¬ã‚¤ãƒ‰

å¤§è¦æ¨¡çµ„ç¹”ãƒ»ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç’°å¢ƒã§ã®å±•é–‹æˆ¦ç•¥ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

## ğŸ“‹ ç›®æ¬¡

1. [ä¼æ¥­å±•é–‹æ¦‚è¦](#ä¼æ¥­å±•é–‹æ¦‚è¦)
2. [å±•é–‹æˆ¦ç•¥](#å±•é–‹æˆ¦ç•¥)
3. [æŠ€è¡“è¦ä»¶](#æŠ€è¡“è¦ä»¶)
4. [å±•é–‹æ–¹æ³•](#å±•é–‹æ–¹æ³•)
5. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …)
6. [ç®¡ç†ãƒ»é‹ç”¨](#ç®¡ç†é‹ç”¨)
7. [ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ã‚µãƒãƒ¼ãƒˆ](#ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚µãƒãƒ¼ãƒˆ)
8. [ç›£è¦–ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹](#ç›£è¦–ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹)

## ğŸŒ ä¼æ¥­å±•é–‹æ¦‚è¦

### å±•é–‹å¯¾è±¡è¦æ¨¡
- **å°è¦æ¨¡**: 50-500ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **ä¸­è¦æ¨¡**: 500-5,000ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **å¤§è¦æ¨¡**: 5,000-50,000ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **è¶…å¤§è¦æ¨¡**: 50,000+ãƒ¦ãƒ¼ã‚¶ãƒ¼

### å±•é–‹ãƒ•ã‚§ãƒ¼ã‚º
1. **è¨ˆç”»ãƒ»è¨­è¨ˆ** (4-6é€±é–“)
2. **ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆå±•é–‹** (2-4é€±é–“)
3. **æ®µéšçš„ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ** (8-12é€±é–“)
4. **æœ¬æ ¼ç¨¼åƒ** (ç¶™ç¶šçš„)

## ğŸ“Š å±•é–‹æˆ¦ç•¥

### ãƒ•ã‚§ãƒ¼ã‚º1: è¨ˆç”»ãƒ»è¨­è¨ˆ

#### è¦ä»¶å®šç¾©
```
âœ… åˆ©ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ãƒ»å¯¾è±¡éƒ¨é–€ç‰¹å®š
âœ… å¿…è¦ãªæ©Ÿèƒ½ãƒ»ãƒ¬ãƒãƒ¼ãƒˆç¨®åˆ¥å®šç¾©
âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¦ä»¶ç¢ºèª
âœ… æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆè¦ä»¶æ•´ç†
âœ… SLAãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶å®šç¾©
```

#### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ
```
ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç®¡ç†è€…ç«¯æœ«     â”‚â”€â”€â”€â”€â”‚   ä¸­å¤®ç®¡ç†ã‚µãƒ¼ãƒãƒ¼   â”‚â”€â”€â”€â”€â”‚   Microsoft 365  â”‚
â”‚ (GUI/CLI)      â”‚    â”‚  (ãƒ¬ãƒãƒ¼ãƒˆé›†ç´„)     â”‚    â”‚     ãƒ†ãƒŠãƒ³ãƒˆ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
                   â”‚                                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
         â”‚   ãƒ¬ãƒãƒ¼ãƒˆã‚µãƒ¼ãƒãƒ¼  â”‚    â”‚   ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚   (SharePoint)  â”‚    â”‚    (ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ•ã‚§ãƒ¼ã‚º2: ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆå±•é–‹

#### ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆå¯¾è±¡
- **ITéƒ¨é–€**: 10-20å
- **çµŒå–¶é™£**: 5-10å
- **å„éƒ¨é–€ä»£è¡¨**: éƒ¨é–€ã‚ãŸã‚Š2-3å

#### ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆæœŸé–“: 2-4é€±é–“
```powershell
# ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆç’°å¢ƒæ§‹ç¯‰
$pilotConfig = @{
    UserCount = 30
    Departments = @("IT", "Management", "Sales", "HR")
    Features = @("GUI", "CLI", "BasicReports")
    TestPeriod = "4weeks"
}
```

### ãƒ•ã‚§ãƒ¼ã‚º3: æ®µéšçš„ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ

#### Wave 1: ITãƒ»ç®¡ç†éƒ¨é–€ (é€±1-2)
- ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ‹…å½“è€…
- ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹æ‹…å½“è€…

#### Wave 2: å„éƒ¨é–€ç®¡ç†è€… (é€±3-6)
- éƒ¨é–€é•·ãƒ»èª²é•·ãƒ¬ãƒ™ãƒ«
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
- ãƒ‡ãƒ¼ã‚¿åˆ†ææ‹…å½“è€…

#### Wave 3: ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ (é€±7-12)
- æ®µéšçš„ãªéƒ¨é–€åˆ¥å±•é–‹
- ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å®Ÿæ–½
- ã‚µãƒãƒ¼ãƒˆä½“åˆ¶ç¢ºç«‹

## ğŸ–¥ï¸ æŠ€è¡“è¦ä»¶

### ã‚¤ãƒ³ãƒ•ãƒ©è¦ä»¶

#### ä¸­å¤®ç®¡ç†ã‚µãƒ¼ãƒãƒ¼
```
æ¨å¥¨ã‚¹ãƒšãƒƒã‚¯:
- OS: Windows Server 2019/2022
- CPU: 8ã‚³ã‚¢ä»¥ä¸Š
- ãƒ¡ãƒ¢ãƒª: 32GBä»¥ä¸Š
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 1TB SSD
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯: 1Gbps
```

#### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¦ä»¶
```
æœ€å°è¦ä»¶:
- OS: Windows 10 Version 1903ä»¥é™
- CPU: 2ã‚³ã‚¢
- ãƒ¡ãƒ¢ãƒª: 4GB
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 10GBç©ºãå®¹é‡

æ¨å¥¨è¦ä»¶:
- OS: Windows 11 22H2ä»¥é™
- CPU: 4ã‚³ã‚¢
- ãƒ¡ãƒ¢ãƒª: 8GB
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 20GBç©ºãå®¹é‡
```

#### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¦ä»¶
```
å¸¯åŸŸå¹…:
- ç®¡ç†è€…ç«¯æœ«: 10Mbpsä»¥ä¸Š
- ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼: 5Mbpsä»¥ä¸Š

æ¥ç¶šå…ˆ:
- Microsoft 365 (*.microsoft.com)
- Microsoft Graph API (graph.microsoft.com)
- PowerShell Gallery (www.powershellgallery.com)
```

### ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¦ä»¶

#### å¿…é ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```
âœ… PowerShell 7.5.1
âœ… .NET 6.0 Runtime
âœ… Microsoft.Graph PowerShell Module
âœ… ExchangeOnlineManagement Module
âœ… Windows PowerShell Execution Policy: RemoteSigned
```

#### æ¨å¥¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```
âœ… Visual C++ Redistributable 2019
âœ… Windows Management Framework 5.1
âœ… PowerShell ISE (é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°ç”¨)
âœ… Git for Windows (ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†)
```

## ğŸš€ å±•é–‹æ–¹æ³•

### 1. Microsoft Intuneå±•é–‹

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ
```powershell
# Intuneç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æº–å‚™
$packagePath = "C:\Deploy\Microsoft365Tools"
$outputPath = "C:\Deploy\Microsoft365Tools.intunewin"

# IntuneWinAppUtilå®Ÿè¡Œ
& "IntuneWinAppUtil.exe" -c $packagePath -s "setup.ps1" -o "C:\Deploy"
```

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
```json
{
  "DisplayName": "Microsoft 365çµ±åˆç®¡ç†ãƒ„ãƒ¼ãƒ«",
  "Description": "GUI/CLIä¸¡å¯¾å¿œã®Microsoft 365ç®¡ç†ãƒ„ãƒ¼ãƒ«",
  "Publisher": "ITéƒ¨é–€",
  "InstallCommandLine": "powershell.exe -ExecutionPolicy Bypass -File setup.ps1",
  "UninstallCommandLine": "powershell.exe -ExecutionPolicy Bypass -File uninstall.ps1",
  "DetectionRules": [
    {
      "Type": "File",
      "Path": "%ProgramFiles%\\Microsoft365Tools",
      "FileOrFolderName": "run_launcher.ps1",
      "Check32BitOn64System": false
    }
  ]
}
```

### 2. System Center Configuration Manager (SCCM)

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
```powershell
# SCCMç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
$appName = "Microsoft 365çµ±åˆç®¡ç†ãƒ„ãƒ¼ãƒ«"
$installCommand = "powershell.exe -ExecutionPolicy Bypass -File setup.ps1"
$uninstallCommand = "powershell.exe -ExecutionPolicy Bypass -File uninstall.ps1"

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸é…å¸ƒãƒã‚¤ãƒ³ãƒˆè¨­å®š
$distributionPoints = @("DP01", "DP02", "DP03")
```

#### å±•é–‹ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
```
- ITç®¡ç†è€…ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
- éƒ¨é–€ç®¡ç†è€…ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
- ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ (æ®µéšçš„)
```

### 3. Group Policy (GPO) å±•é–‹

#### ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨­å®š
```powershell
# GPO ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# \\domain\sysvol\scripts\deploy-m365tools.ps1

param(
    [string]$InstallPath = "$env:ProgramFiles\Microsoft365Tools"
)

# ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±•é–‹
$sourcePath = "\\fileserver\software\Microsoft365Tools"
if (Test-Path $sourcePath) {
    Copy-Item -Path $sourcePath -Destination $InstallPath -Recurse -Force
    
    # ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆä½œæˆ
    & "$InstallPath\Create-Shortcuts.ps1" -AllUsers -Quiet
}
```

### 4. æ‰‹å‹•å±•é–‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

#### ä¸€æ‹¬å±•é–‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```powershell
# deploy-bulk.ps1
param(
    [string[]]$ComputerNames,
    [PSCredential]$Credential
)

foreach ($computer in $ComputerNames) {
    Invoke-Command -ComputerName $computer -Credential $Credential -ScriptBlock {
        # PowerShell 7.5.1ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        $msiPath = "\\fileserver\software\PowerShell-7.5.1-win-x64.msi"
        Start-Process msiexec.exe -ArgumentList "/i `"$msiPath`" /qn" -Wait
        
        # ãƒ„ãƒ¼ãƒ«å±•é–‹
        $toolsPath = "\\fileserver\software\Microsoft365Tools"
        $localPath = "$env:ProgramFiles\Microsoft365Tools"
        Copy-Item -Path $toolsPath -Destination $localPath -Recurse -Force
        
        # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«é…ç½®
        $configSource = "\\fileserver\configs\appsettings.json"
        Copy-Item -Path $configSource -Destination "$localPath\Config\appsettings.json"
    }
}
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### Azure AD ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç™»éŒ²

#### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
```powershell
# Microsoft Graph PowerShellä½¿ç”¨
Connect-MgGraph -Scopes "Application.ReadWrite.All"

$app = New-MgApplication -DisplayName "Microsoft 365çµ±åˆç®¡ç†ãƒ„ãƒ¼ãƒ«" `
    -SignInAudience "AzureADMyOrg"
```

#### 2. APIæ¨©é™è¨­å®š
```powershell
# å¿…è¦ãªæ¨©é™è¿½åŠ 
$requiredPermissions = @(
    "User.Read.All",
    "Group.Read.All", 
    "Directory.Read.All",
    "Reports.Read.All",
    "AuditLog.Read.All"
)

foreach ($permission in $requiredPermissions) {
    Add-MgApplicationApiPermission -ApplicationId $app.Id -ApiId "00000003-0000-0000-c000-000000000000" -PermissionId $permission
}
```

#### 3. è¨¼æ˜æ›¸èªè¨¼è¨­å®š
```powershell
# è¨¼æ˜æ›¸ä½œæˆ
$cert = New-SelfSignedCertificate -Subject "CN=Microsoft365Tools" `
    -CertStoreLocation "Cert:\CurrentUser\My" `
    -KeyExportPolicy Exportable `
    -KeySpec Signature `
    -KeyUsage DigitalSignature `
    -NotAfter (Get-Date).AddYears(2)

# è¨¼æ˜æ›¸ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿½åŠ 
$certData = [System.Convert]::ToBase64String($cert.RawData)
New-MgApplicationKeyCredential -ApplicationId $app.Id -KeyCredential @{
    Type = "AsymmetricX509Cert"
    Usage = "Verify"
    Key = [System.Text.Encoding]::UTF8.GetBytes($certData)
}
```

### æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹

#### ç®¡ç†ãƒ„ãƒ¼ãƒ«å°‚ç”¨ãƒãƒªã‚·ãƒ¼
```json
{
  "displayName": "Microsoft 365ç®¡ç†ãƒ„ãƒ¼ãƒ« - ç®¡ç†è€…ã‚¢ã‚¯ã‚»ã‚¹",
  "state": "enabled",
  "conditions": {
    "applications": {
      "includeApplications": ["your-app-id"]
    },
    "users": {
      "includeGroups": ["IT-Administrators"]
    },
    "locations": {
      "includeLocations": ["Corporate-Network"]
    }
  },
  "grantControls": {
    "operator": "AND",
    "builtInControls": ["mfa", "compliantDevice"]
  }
}
```

### ãƒ‡ãƒ¼ã‚¿ä¿è­·

#### æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–
```powershell
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æš—å·åŒ–
$configPath = "Config\appsettings.json"
$encryptedPath = "Config\appsettings.json.encrypted"

# AESæš—å·åŒ–
$key = (Get-Content "encryption.key" -AsByteStream)
$content = Get-Content $configPath -Raw
$encrypted = ConvertTo-SecureString $content -AsPlainText -Force | ConvertFrom-SecureString -Key $key
Set-Content -Path $encryptedPath -Value $encrypted
```

## ğŸ“Š ç®¡ç†ãƒ»é‹ç”¨

### ä¸­å¤®ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰

#### é›†ç´„ãƒ¬ãƒãƒ¼ãƒˆã‚µãƒ¼ãƒãƒ¼
```powershell
# ä¸­å¤®ãƒ¬ãƒãƒ¼ãƒˆåé›†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# collect-reports.ps1

param(
    [string[]]$SourceComputers,
    [string]$CentralRepository = "\\reports\Microsoft365Reports"
)

foreach ($computer in $SourceComputers) {
    $remotePath = "\\$computer\c$\Microsoft365Tools\Reports"
    $todayFolder = Join-Path $CentralRepository (Get-Date -Format "yyyy-MM-dd")
    
    if (Test-Path $remotePath) {
        Copy-Item -Path "$remotePath\*" -Destination "$todayFolder\$computer" -Recurse -Force
    }
}
```

#### SharePointçµ±åˆ
```powershell
# SharePoint Online ãƒ¬ãƒãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
Connect-PnPOnline -Url "https://your-org.sharepoint.com/sites/reports" -Interactive

$reportFiles = Get-ChildItem "Reports" -Filter "*.html"
foreach ($file in $reportFiles) {
    Add-PnPFile -Path $file.FullName -Folder "Microsoft365Reports"
}
```

### ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ

#### ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç›£è¦–
```powershell
# health-check.ps1 - å®šæœŸå®Ÿè¡Œç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
$computers = Get-Content "computers.txt"
$results = @()

foreach ($computer in $computers) {
    $result = Invoke-Command -ComputerName $computer -ScriptBlock {
        Test-Path "$env:ProgramFiles\Microsoft365Tools\run_launcher.ps1"
    } -ErrorAction SilentlyContinue
    
    $results += [PSCustomObject]@{
        Computer = $computer
        Status = if ($result) { "æ­£å¸¸" } else { "ç•°å¸¸" }
        LastCheck = Get-Date
    }
}

# ã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡ (ç•°å¸¸æ¤œå‡ºæ™‚)
$failures = $results | Where-Object Status -eq "ç•°å¸¸"
if ($failures) {
    Send-MailMessage -To "admin@your-org.com" -Subject "Microsoft 365ç®¡ç†ãƒ„ãƒ¼ãƒ« éšœå®³ã‚¢ãƒ©ãƒ¼ãƒˆ" -Body ($failures | Out-String)
}
```

## ğŸ‘¥ ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ã‚µãƒãƒ¼ãƒˆ

### ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

#### ç®¡ç†è€…å‘ã‘ (2æ—¥é–“)
```
Day 1: ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦ãƒ»è¨­å®š
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç†è§£
- èªè¨¼è¨­å®š
- åŸºæœ¬æ“ä½œ (GUI/CLI)
- ãƒ¬ãƒãƒ¼ãƒˆè¨­å®š

Day 2: é‹ç”¨ãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- æ—¥å¸¸é‹ç”¨æ‰‹é †
- ç›£è¦–ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
- å•é¡Œè§£æ±ºæ‰‹æ³•
- ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
```

#### ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ (åŠæ—¥)
```
åˆå‰: åŸºæœ¬æ“ä½œ
- GUIæ“ä½œæ–¹æ³•
- ãƒ¬ãƒãƒ¼ãƒˆé–²è¦§
- åŸºæœ¬çš„ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

åˆå¾Œ: å®Ÿè·µãƒ»Q&A
- å®Ÿéš›ã®æ¥­å‹™ã‚·ãƒŠãƒªã‚ª
- ã‚ˆãã‚ã‚‹è³ªå•
- ã‚µãƒãƒ¼ãƒˆçª“å£æ¡ˆå†…
```

### ã‚µãƒãƒ¼ãƒˆä½“åˆ¶

#### 3æ®µéšã‚µãƒãƒ¼ãƒˆ
```
Level 1: ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚µãƒãƒ¼ãƒˆ
- åŸºæœ¬æ“ä½œæ”¯æ´
- ä¸€èˆ¬çš„ãªå•é¡Œè§£æ±º
- ç¤¾å†…FAQå¯¾å¿œ

Level 2: æŠ€è¡“ã‚µãƒãƒ¼ãƒˆ
- ã‚·ã‚¹ãƒ†ãƒ è¨­å®šæ”¯æ´
- ä¸­ç´šãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

Level 3: å°‚é–€ã‚µãƒãƒ¼ãƒˆ
- é«˜åº¦ãªæŠ€è¡“å•é¡Œ
- ã‚·ã‚¹ãƒ†ãƒ éšœå®³å¯¾å¿œ
- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
```

### ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰

#### FAQä½œæˆ
```markdown
## ã‚ˆãã‚ã‚‹è³ªå•

### Q: GUIãŒèµ·å‹•ã—ãªã„
A: PowerShell 7.5.1ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚
   ã‚³ãƒãƒ³ãƒ‰: `pwsh -Version`

### Q: èªè¨¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹
A: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èªè¨¼æƒ…å ±ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
   ãƒ•ã‚¡ã‚¤ãƒ«: `Config\appsettings.json`

### Q: ãƒ¬ãƒãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œãªã„
A: Microsoft 365ã¸ã®æ¥ç¶šã¨APIæ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
   ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰: `.\test-auth-simple.ps1`
```

## ğŸ“ˆ ç›£è¦–ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

#### æœˆæ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
```powershell
# monthly-maintenance.ps1
# 1. ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
Get-ChildItem "Logs" -Filter "*.log" | Where-Object LastWriteTime -lt (Get-Date).AddDays(-30) | Remove-Item

# 2. ãƒ¬ãƒãƒ¼ãƒˆã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
$archivePath = "Archive\Reports\$(Get-Date -Format 'yyyy-MM')"
New-Item -Path $archivePath -ItemType Directory -Force
Move-Item "Reports\*" -Destination $archivePath

# 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
Copy-Item "Config\appsettings.json" -Destination "Config\appsettings.json.backup.$(Get-Date -Format 'yyyyMMdd')"

# 4. ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ãƒã‚§ãƒƒã‚¯
.\Check-System.ps1 -Detailed | Out-File "HealthCheck-$(Get-Date -Format 'yyyyMMdd').log"
```

#### å››åŠæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
```powershell
# quarterly-maintenance.ps1
# 1. PowerShellæ›´æ–°ç¢ºèª
$currentVersion = $PSVersionTable.PSVersion
$latestVersion = (Invoke-RestMethod "https://api.github.com/repos/PowerShell/PowerShell/releases/latest").tag_name

# 2. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ›´æ–°
Update-Module Microsoft.Graph -Force
Update-Module ExchangeOnlineManagement -Force

# 3. è¨¼æ˜æ›¸æœ‰åŠ¹æœŸé™ç¢ºèª
Get-ChildItem Cert:\CurrentUser\My | Where-Object NotAfter -lt (Get-Date).AddDays(90)

# 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ
Measure-Command { .\Apps\CliApp.ps1 -Action auth } | Out-File "Performance-$(Get-Date -Format 'yyyyMMdd').log"
```

### ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

#### Power BI çµ±åˆ
```powershell
# PowerBI ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æº–å‚™
$reportData = Get-ChildItem "Reports" -Recurse -Filter "*.csv" | ForEach-Object {
    Import-Csv $_.FullName | Add-Member -NotePropertyName "ReportDate" -NotePropertyValue $_.LastWriteTime -PassThru
}

$reportData | Export-Csv "PowerBI-Data-$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation
```

#### Azure Monitor çµ±åˆ
```json
{
  "workspaceId": "your-workspace-id",
  "queries": [
    {
      "name": "Microsoft365ToolsErrors",
      "query": "Event | where Source == 'Microsoft365Tools' and EventLevelName == 'Error'"
    },
    {
      "name": "ReportGenerationMetrics", 
      "query": "Perf | where ObjectName == 'Microsoft365Tools' and CounterName == 'ReportsGenerated'"
    }
  ]
}
```

## ğŸ“Š æˆåŠŸæŒ‡æ¨™ãƒ»KPI

### æŠ€è¡“æŒ‡æ¨™
- **ã‚·ã‚¹ãƒ†ãƒ å¯ç”¨æ€§**: 99.9%ä»¥ä¸Š
- **ãƒ¬ãƒãƒ¼ãƒˆç”ŸæˆæˆåŠŸç‡**: 99%ä»¥ä¸Š
- **å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“**: 30ç§’ä»¥å†…
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦**: 4.0/5.0ä»¥ä¸Š

### ãƒ“ã‚¸ãƒã‚¹æŒ‡æ¨™
- **ç®¡ç†åŠ¹ç‡å‘ä¸Š**: 50%ä»¥ä¸Š
- **ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¯¾å¿œæ™‚é–“çŸ­ç¸®**: 70%ä»¥ä¸Š
- **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆæ¤œå‡ºæ™‚é–“çŸ­ç¸®**: 80%ä»¥ä¸Š
- **ç·æ‰€æœ‰ã‚³ã‚¹ãƒˆå‰Šæ¸›**: 30%ä»¥ä¸Š

### æ¸¬å®šæ–¹æ³•
```powershell
# KPIæ¸¬å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆ
$kpiData = @{
    SystemUptime = (Get-Uptime).Days
    SuccessfulReports = (Get-ChildItem "Reports" -Filter "*.html" | Measure-Object).Count
    AverageResponseTime = (Measure-Command { .\test-auth-simple.ps1 }).TotalSeconds
    UserFeedback = Import-Csv "UserFeedback.csv" | Measure-Object Rating -Average
}

$kpiData | ConvertTo-Json | Out-File "KPI-$(Get-Date -Format 'yyyyMMdd').json"
```

---

**ğŸ“ ä¼æ¥­å±•é–‹ã‚µãƒãƒ¼ãƒˆ**: å¤§è¦æ¨¡å±•é–‹ã«é–¢ã™ã‚‹ãŠå•ã„åˆã‚ã›ã¯ã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚µãƒãƒ¼ãƒˆãƒãƒ¼ãƒ ã¾ã§ã”é€£çµ¡ãã ã•ã„ã€‚