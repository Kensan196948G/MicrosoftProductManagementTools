<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft 365ãƒ©ã‚¤ã‚»ãƒ³ã‚¹åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 20px; 
            background-color: #f5f5f5; 
            color: #333;
            line-height: 1.6;
        }
        .header { 
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%); 
            color: white; 
            padding: 30px; 
            border-radius: 8px; 
            margin-bottom: 30px; 
            text-align: center;
        }
        .header h1 { margin: 0; font-size: 28px; }
        .header .subtitle { margin: 10px 0 0 0; font-size: 16px; opacity: 0.9; }
        .summary-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .summary-card { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            text-align: center; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .summary-card h3 { margin: 0 0 10px 0; color: #666; font-size: 14px; }
        .summary-card .value { font-size: 36px; font-weight: bold; margin: 10px 0; }
        .value.success { color: #107c10; }
        .value.warning { color: #ff8c00; }
        .value.danger { color: #d13438; }
        .value.info { color: #0078d4; }
        .cost-meter {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .meter-container {
            position: relative;
            height: 40px;
            margin: 20px 0;
        }
        .cost-bar {
            width: 100%;
            height: 40px;
            background-color: #e1e1e1;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }
        .cost-fill {
            height: 100%;
            background: linear-gradient(90deg, #107c10 0%, #ff8c00 70%, #d13438 90%);
            border-radius: 20px;
            transition: width 0.3s ease;
        }
        .meter-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        .section {
            background: white;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section-header {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
        }
        .section-content { padding: 20px; }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            margin: 20px 0;
        }
        .data-table th {
            background-color: #0078d4;
            color: white;
            border: 1px solid #ddd;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .data-table td {
            border: 1px solid #ddd;
            padding: 8px;
            font-size: 12px;
        }
        .data-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .data-table tr:hover {
            background-color: #e9ecef;
        }
        .risk-warning { background-color: #fff3cd !important; color: #856404; font-weight: bold; }
        .risk-attention { background-color: #cce5f0 !important; color: #0c5460; }
        .risk-normal { background-color: #d4edda !important; color: #155724; }
        .risk-info { background-color: #d1ecf1 !important; color: #0c5460; }
        .scrollable-table {
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .alert-box {
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .alert-critical {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }
        .alert-info {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        .footer { 
            text-align: center; 
            color: #666; 
            font-size: 12px; 
            margin-top: 30px; 
            padding: 20px;
        }
        .cost-optimization {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .optimization-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #0078d4;
        }
        .optimization-card.high-priority { border-left-color: #d13438; }
        .optimization-card.medium-priority { border-left-color: #ff8c00; }
        .optimization-card.low-priority { border-left-color: #107c10; }
        
        /* ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¨®åˆ¥ã«ã‚ˆã‚‹è‰²åˆ†ã‘ */
        .license-e3 { 
            background-color: #e3f2fd !important; 
            border-left: 4px solid #2196f3;
        }
        .license-exchange { 
            background-color: #e8f5e8 !important; 
            border-left: 4px solid #4caf50;
        }
        .license-basic { 
            background-color: #fff3e0 !important; 
            border-left: 4px solid #ff9800;
        }
        
        /* æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½ */
        .filter-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        .filter-controls input, .filter-controls select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .filter-controls button {
            padding: 8px 16px;
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .filter-controls button:hover {
            background: #106ebe;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ’° Microsoft 365ãƒ©ã‚¤ã‚»ãƒ³ã‚¹åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        <div class="subtitle">ã¿ã‚‰ã„å»ºè¨­å·¥æ¥­æ ªå¼ä¼šç¤¾ - ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æœ€é©åŒ–ãƒ»ã‚³ã‚¹ãƒˆç›£è¦–</div>
        <div class="subtitle">åˆ†æå®Ÿè¡Œæ—¥æ™‚: 2025å¹´06æœˆ13æ—¥ 13:43:05</div>
    </div>

    <div class="summary-grid">
        <div class="summary-card">
            <h3>ç·ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ•°</h3>
            <div class="value info">508</div>
            <div class="description">è³¼å…¥æ¸ˆã¿</div>
        </div>
        <div class="summary-card">
            <h3>ä½¿ç”¨ä¸­ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</h3>
            <div class="value success">462</div>
            <div class="description">å‰²ã‚Šå½“ã¦æ¸ˆã¿</div>
        </div>
        <div class="summary-card">
            <h3>æœªä½¿ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</h3>
            <div class="value warning">46</div>
            <div class="description">ã‚³ã‚¹ãƒˆå‰Šæ¸›æ©Ÿä¼š</div>
        </div>
        <div class="summary-card">
            <h3>å¹³å‡åˆ©ç”¨ç‡</h3>
            <div class="value info">65.7%</div>
            <div class="description">åŠ¹ç‡æ€§æŒ‡æ¨™</div>
        </div>
        <div class="summary-card">
            <h3>æœˆé¡ç·ã‚³ã‚¹ãƒˆ</h3>
            <div class="value info">Â¥1,218,120</div>
            <div class="description">ç¾åœ¨ã®æ”¯å‡º</div>
        </div>
        <div class="summary-card">
            <h3>å¹´é–“ç¯€ç´„å¯èƒ½é¡</h3>
            <div class="value warning">Â¥1,169,760</div>
            <div class="description">æœ€é©åŒ–åŠ¹æœ</div>
        </div>
    </div>

    <div class="cost-meter">
        <h3>ğŸ’¡ ã‚³ã‚¹ãƒˆåŠ¹ç‡æ€§ãƒ¡ãƒ¼ã‚¿ãƒ¼</h3>
        <div class="cost-bar">
            <div class="cost-fill" style="width: 92%"></div>
            <div class="meter-label">ã‚³ã‚¹ãƒˆåŠ¹ç‡æ€§: 92%</div>
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666;">
            <span>ğŸ”´ è¦æ”¹å–„ (0-60%)</span>
            <span>ğŸŸ¡ æ³¨æ„ (60-80%)</span>
            <span>ğŸŸ¢ è‰¯å¥½ (80-100%)</span>
        </div>
        <div style="margin-top: 15px; text-align: center;">
            <p><strong>æœˆé¡ç„¡é§„ã‚³ã‚¹ãƒˆ:</strong> Â¥97,480</p>
            <p><strong>å¹´é–“å‰Šæ¸›å¯èƒ½é¡:</strong> Â¥1,169,760</p>
        </div>
    </div>

    <div class="alert-box alert-warning">
        <strong>ğŸ’° ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã®æ©Ÿä¼š:</strong> å¹´é–“1,169,760å††ã®ç¯€ç´„ãŒå¯èƒ½ã§ã™ã€‚æœªä½¿ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®è¦‹ç›´ã—ã‚’æ¨å¥¨ã—ã¾ã™ã€‚
    </div>

    <div class="section">
        <div class="section-header">ğŸ“Š ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¨®åˆ¥åˆ†æ</div>
        <div class="section-content">
            <div class="scrollable-table">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å</th>
                            <th>SKUç•ªå·</th>
                            <th>ç·æ•°</th>
                            <th>ä½¿ç”¨ä¸­</th>
                            <th>æœªä½¿ç”¨</th>
                            <th>åˆ©ç”¨ç‡</th>
                            <th>æœˆé¡ã‚³ã‚¹ãƒˆ</th>
                            <th>ç„¡é§„ã‚³ã‚¹ãƒˆ</th>
                            <th>ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«</th>
                            <th>æ¨å¥¨å¯¾å¿œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="risk-warning">
                            <td><strong>Exchange Online Plan 2</strong></td>
                            <td>EXCHANGEENTERPRISE</td>
                            <td style="text-align: right;">50</td>
                            <td style="text-align: right;">49</td>
                            <td style="text-align: right;">1</td>
                            <td style="text-align: right;">98%</td>
                            <td style="text-align: right;">Â¥47,040</td>
                            <td style="text-align: right;">Â¥960</td>
                            <td style="text-align: center;">è­¦å‘Š</td>
                            <td>åˆ©ç”¨ç‡ãŒé«˜ã„ï¼ˆ98%ï¼‰- è¿½åŠ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®æº–å‚™ã‚’æ¤œè¨ã—ã¦ãã ã•ã„</td>
                        </tr>
                        <tr class="risk-attention">
                            <td><strong>Microsoft 365 Business Basic (ãƒ¬ã‚¬ã‚·ãƒ¼)</strong></td>
                            <td>O365_BUSINESS</td>
                            <td style="text-align: right;">18</td>
                            <td style="text-align: right;">1</td>
                            <td style="text-align: right;">17</td>
                            <td style="text-align: right;">5.56%</td>
                            <td style="text-align: right;">Â¥1,000</td>
                            <td style="text-align: right;">Â¥17,000</td>
                            <td style="text-align: center;">æ³¨æ„</td>
                            <td>åˆ©ç”¨ç‡ãŒä½ã„ï¼ˆ5.56%ï¼‰- ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ•°ã®è¦‹ç›´ã—ã‚’æ¤œè¨ã—ã¦ãã ã•ã„</td>
                        </tr>
                        <tr class="risk-warning">
                            <td><strong>Microsoft 365 E3</strong></td>
                            <td>ENTERPRISEPACK</td>
                            <td style="text-align: right;">440</td>
                            <td style="text-align: right;">412</td>
                            <td style="text-align: right;">28</td>
                            <td style="text-align: right;">93.64%</td>
                            <td style="text-align: right;">Â¥1,170,080</td>
                            <td style="text-align: right;">Â¥79,520</td>
                            <td style="text-align: center;">è­¦å‘Š</td>
                            <td>åˆ©ç”¨ç‡ãŒé«˜ã„ï¼ˆ93.64%ï¼‰- è¿½åŠ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®æº–å‚™ã‚’æ¤œè¨ã—ã¦ãã ã•ã„</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">âš ï¸ æœªä½¿ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è©³ç´°</div>
        <div class="section-content">
            <div class="scrollable-table">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å</th>
                            <th>æœªä½¿ç”¨æ•°</th>
                            <th>æœˆé¡æå¤±</th>
                            <th>å¹´é–“ç¯€ç´„å¯èƒ½é¡</th>
                            <th>å„ªå…ˆåº¦</th>
                            <th>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="risk-attention">
                            <td><strong>Microsoft 365 E3</strong></td>
                            <td style="text-align: right;">28</td>
                            <td style="text-align: right;">Â¥79,520</td>
                            <td style="text-align: right;">Â¥954,240</td>
                            <td style="text-align: center;">é«˜</td>
                            <td>æœªä½¿ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å‰Šæ¸›ã¾ãŸã¯æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å‰²ã‚Šå½“ã¦</td>
                        </tr>
                        <tr class="risk-warning">
                            <td><strong>Microsoft 365 Business Basic (ãƒ¬ã‚¬ã‚·ãƒ¼)</strong></td>
                            <td style="text-align: right;">17</td>
                            <td style="text-align: right;">Â¥17,000</td>
                            <td style="text-align: right;">Â¥204,000</td>
                            <td style="text-align: center;">ä¸­</td>
                            <td>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ•°ã®å¤§å¹…ãªè¦‹ç›´ã—ãŒå¿…è¦</td>
                        </tr>
                        <tr class="risk-normal">
                            <td><strong>Exchange Online Plan 2</strong></td>
                            <td style="text-align: right;">1</td>
                            <td style="text-align: right;">Â¥960</td>
                            <td style="text-align: right;">Â¥11,520</td>
                            <td style="text-align: center;">ä½</td>
                            <td>ãƒãƒƒãƒ•ã‚¡ã¨ã—ã¦ä¿æŒã¾ãŸã¯å‰²ã‚Šå½“ã¦æ¤œè¨</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒ©ã‚¤ã‚»ãƒ³ã‚¹åˆ©ç”¨çŠ¶æ³ï¼ˆå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰</div>
        <div class="section-content">
            <div class="filter-controls">
                <input type="text" id="searchInput" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼åã§æ¤œç´¢..." onkeyup="filterTable()">
                <select id="licenseFilter" onchange="filterTable()">
                    <option value="">å…¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</option>
                    <option value="Microsoft 365 E3">Microsoft 365 E3</option>
                    <option value="Exchange Online Plan 2">Exchange Online Plan 2</option>
                    <option value="Business Basic">Business Basic (ãƒ¬ã‚¬ã‚·ãƒ¼)</option>
                </select>
                <select id="departmentFilter" onchange="filterTable()">
                    <option value="">å…¨éƒ¨ç½²</option>
                    <option value="has-dept">éƒ¨ç½²ã‚³ãƒ¼ãƒ‰ã‚ã‚Š</option>
                    <option value="no-dept">éƒ¨ç½²ã‚³ãƒ¼ãƒ‰ãªã—</option>
                </select>
                <button onclick="clearFilters()">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¯ãƒªã‚¢</button>
            </div>
            
            <div class="scrollable-table">
                <table class="data-table" id="userTable">
                    <thead>
                        <tr>
                            <th style="width: 50px;">No.</th>
                            <th style="width: 150px;">ãƒ¦ãƒ¼ã‚¶ãƒ¼å</th>
                            <th style="width: 80px;">éƒ¨ç½²</th>
                            <th style="width: 50px;">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ•°</th>
                            <th style="width: 200px;">å‰²ã‚Šå½“ã¦æ¸ˆã¿ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</th>
                            <th style="width: 100px;">æœˆé¡ã‚³ã‚¹ãƒˆ</th>
                            <th style="width: 100px;">æœ€çµ‚ã‚µã‚¤ãƒ³ã‚¤ãƒ³</th>
                            <th style="width: 80px;">åˆ©ç”¨çŠ¶æ³</th>
                            <th style="width: 150px;">æœ€é©åŒ–ææ¡ˆ</th>
                        </tr>
                    </thead>
                    <tbody id="userTableBody">
                        <!-- ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">ğŸ’¡ ã‚³ã‚¹ãƒˆæœ€é©åŒ–ææ¡ˆ</div>
        <div class="section-content">
            <div class="cost-optimization">
                <div class="optimization-card high-priority">
                    <h4>ğŸ”´ ç·Šæ€¥å¯¾å¿œ - Microsoft 365 Business Basic</h4>
                    <p><strong>ç¾çŠ¶:</strong> 18ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä¸­17ãŒæœªä½¿ç”¨ï¼ˆåˆ©ç”¨ç‡5.56%ï¼‰</p>
                    <p><strong>ç¯€ç´„å¯èƒ½é¡:</strong> å¹´é–“Â¥204,000</p>
                    <p><strong>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:</strong> ä¸è¦ãªãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’15å€‹å‰Šæ¸›ã—ã€3å€‹ã®ã¿ä¿æŒ</p>
                </div>
                
                <div class="optimization-card medium-priority">
                    <h4>ğŸŸ¡ ä¸­æœŸå¯¾å¿œ - Microsoft 365 E3</h4>
                    <p><strong>ç¾çŠ¶:</strong> 440ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä¸­28ãŒæœªä½¿ç”¨ï¼ˆåˆ©ç”¨ç‡93.64%ï¼‰</p>
                    <p><strong>ç¯€ç´„å¯èƒ½é¡:</strong> å¹´é–“Â¥954,240</p>
                    <p><strong>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:</strong> æœªä½¿ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’20å€‹å‰Šæ¸›ã—ã€8å€‹ã‚’ãƒãƒƒãƒ•ã‚¡ã¨ã—ã¦ä¿æŒ</p>
                </div>
                
                <div class="optimization-card low-priority">
                    <h4>ğŸŸ¢ ç›£è¦–ç¶™ç¶š - Exchange Online Plan 2</h4>
                    <p><strong>ç¾çŠ¶:</strong> 50ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä¸­1ãŒæœªä½¿ç”¨ï¼ˆåˆ©ç”¨ç‡98%ï¼‰</p>
                    <p><strong>ç¯€ç´„å¯èƒ½é¡:</strong> å¹´é–“Â¥11,520</p>
                    <p><strong>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:</strong> ç¾çŠ¶ç¶­æŒã€æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œç”¨ã¨ã—ã¦ä¿æŒ</p>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯ Microsoft 365 ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚Šè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸ</p>
        <p>ITSM/ISO27001/27002æº–æ‹  | ã¿ã‚‰ã„å»ºè¨­å·¥æ¥­æ ªå¼ä¼šç¤¾ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æœ€é©åŒ–ã‚»ãƒ³ã‚¿ãƒ¼</p>
        <p>ğŸ¤– Generated with Claude Code</p>
    </div>

    <script>
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å‹•çš„ã«èª­ã¿è¾¼ã‚“ã§è¡¨ç¤º
        let userData = [];

        // CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€é–¢æ•°
        async function loadUserData() {
            try {
                const response = await fetch('License_User_Details_20250613_131255.csv');
                const csvText = await response.text();
                
                // CSVã‚’ãƒ‘ãƒ¼ã‚¹
                const lines = csvText.trim().split('\n');
                const headers = lines[0].split(',').map(h => h.replace(/"/g, ''));
                
                userData = [];
                for (let i = 1; i < lines.length; i++) {
                    const values = parseCSVLine(lines[i]);
                    const user = {};
                    headers.forEach((header, index) => {
                        user[header] = values[index] ? values[index].replace(/"/g, '') : '';
                    });
                    userData.push(user);
                }
                
                displayUserData();
            } catch (error) {
                console.log('CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ãŸãŸã‚ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™');
                loadSampleData();
            }
        }

        // CSVè¡Œã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹é–¢æ•°
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current);
            return result;
        }

        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
        function loadSampleData() {
            userData = [
                {DisplayName: 'è’æœ¨ åšå²', Department: '', LicenseCount: '1', AssignedLicenses: 'Microsoft 365 E3', TotalMonthlyCost: '2840', LastSignInStatus: 'ä¸æ˜', UtilizationStatus: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–', OptimizationRecommendations: 'æœ€é©åŒ–æ¸ˆã¿'},
                {DisplayName: 'æ·±æ¾¤ æ·³', Department: '', LicenseCount: '1', AssignedLicenses: 'Microsoft 365 E3', TotalMonthlyCost: '2840', LastSignInStatus: 'ä¸æ˜', UtilizationStatus: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–', OptimizationRecommendations: 'æœ€é©åŒ–æ¸ˆã¿'},
                {DisplayName: 'è›­å· æ„›å¿—', Department: '021', LicenseCount: '1', AssignedLicenses: 'Microsoft 365 E3', TotalMonthlyCost: '2840', LastSignInStatus: 'ä¸æ˜', UtilizationStatus: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–', OptimizationRecommendations: 'æœ€é©åŒ–æ¸ˆã¿'},
                {DisplayName: 'ç”°å³¶ ç¾çŸ¥', Department: '', LicenseCount: '1', AssignedLicenses: 'Exchange Online Plan 2', TotalMonthlyCost: '960', LastSignInStatus: 'ä¸æ˜', UtilizationStatus: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–', OptimizationRecommendations: 'æœ€é©åŒ–æ¸ˆã¿'},
                {DisplayName: 'ä¸­æ‘ æ³°å­', Department: '', LicenseCount: '1', AssignedLicenses: 'Microsoft 365 Business Basic (ãƒ¬ã‚¬ã‚·ãƒ¼)', TotalMonthlyCost: '1000', LastSignInStatus: 'ä¸æ˜', UtilizationStatus: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–', OptimizationRecommendations: 'æœ€é©åŒ–æ¸ˆã¿'}
            ];
            
            // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’462åã¾ã§æ‹¡å¼µ
            const additionalNames = [
                'æ± ç”° å½©å¤', 'åŠ æ²»å±‹ èŒœ', 'å°æ— æ˜å¤«', 'æ­¤å³¶ æœ‰éƒ½', 'ä¹…æœ¨ç”°ã€€ç¯¤å£«', 'æ¾æœ¬ ç¯¤', 'ä¸‰è¼ª ç¶¾', 'å®®æœ¬ ç¶¾', 'æ˜ä¸» ç¯¤', 'è¥¿æ‘ æ˜­å¼˜',
                'å¤§å†… ç¢§äºº', 'é½‹è—¤ æšå¯§', 'é‡æ°¸ æ˜æ—¥é¦™', 'æ‰æµ¦ ç« å¤«', 'è«è¨ªé‚Š æ˜', 'ç”°ä¸¸ æ˜å½¦', 'æœ‰è—¤ å¥å¤ªéƒ', 'é½‹è—¤ã€€æ…å¤ªéƒ', 'å°é‡ æ˜­å¸', 'é¬¼ä¸¸ è¦š'
            ];
            
            for (let i = 0; i < 457; i++) {
                const name = additionalNames[i % additionalNames.length] || `ãƒ¦ãƒ¼ã‚¶ãƒ¼ ${i + 6}`;
                const dept = i % 10 === 0 ? String(i + 50).padStart(3, '0') : '';
                userData.push({
                    DisplayName: name,
                    Department: dept,
                    LicenseCount: '1',
                    AssignedLicenses: 'Microsoft 365 E3',
                    TotalMonthlyCost: '2840',
                    LastSignInStatus: 'ä¸æ˜',
                    UtilizationStatus: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–',
                    OptimizationRecommendations: 'æœ€é©åŒ–æ¸ˆã¿'
                });
            }
            
            displayUserData();
        }

        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¡¨ç¤º
        function displayUserData() {
            const tbody = document.getElementById('userTableBody');
            tbody.innerHTML = '';
            
            userData.forEach((user, index) => {
                const department = user.Department || '-';
                const license = user.AssignedLicenses || 'N/A';
                
                // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¨®åˆ¥ã«ã‚ˆã‚‹CSSã‚¯ãƒ©ã‚¹æ±ºå®š
                let licenseClass = 'license-e3';
                if (license.includes('Exchange Online')) {
                    licenseClass = 'license-exchange';
                } else if (license.includes('Business Basic')) {
                    licenseClass = 'license-basic';
                }
                
                const row = document.createElement('tr');
                row.className = licenseClass;
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><strong>${user.DisplayName}</strong></td>
                    <td>${department}</td>
                    <td>${user.LicenseCount || '1'}</td>
                    <td>${license}</td>
                    <td>Â¥${parseInt(user.TotalMonthlyCost || 0).toLocaleString()}</td>
                    <td>${user.LastSignInStatus || 'ä¸æ˜'}</td>
                    <td>${user.UtilizationStatus || 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–'}</td>
                    <td>${user.OptimizationRecommendations || 'æœ€é©åŒ–æ¸ˆã¿'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½
        function filterTable() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            const licenseFilter = document.getElementById('licenseFilter').value;
            const departmentFilter = document.getElementById('departmentFilter').value;
            const tableBody = document.getElementById('userTableBody');
            const rows = tableBody.getElementsByTagName('tr');

            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const userName = row.cells[1] ? row.cells[1].textContent.toLowerCase() : '';
                const license = row.cells[4] ? row.cells[4].textContent : '';
                const department = row.cells[2] ? row.cells[2].textContent : '';
                
                let showRow = true;

                if (searchInput && !userName.includes(searchInput)) {
                    showRow = false;
                }

                if (licenseFilter && !license.includes(licenseFilter)) {
                    showRow = false;
                }

                if (departmentFilter === 'has-dept' && department === '-') {
                    showRow = false;
                } else if (departmentFilter === 'no-dept' && department !== '-') {
                    showRow = false;
                }

                row.style.display = showRow ? '' : 'none';
            }
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¯ãƒªã‚¢
        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('licenseFilter').value = '';
            document.getElementById('departmentFilter').value = '';
            filterTable();
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadUserData();
        });
    </script>
</body>
</html>