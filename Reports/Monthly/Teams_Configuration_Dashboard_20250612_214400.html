<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Teams構成分析ダッシュボード - みらい建設工業株式会社</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 20px; 
            background-color: #f5f5f5; 
            color: #333;
            line-height: 1.6;
        }
        .header { 
            background: linear-gradient(135deg, #6264a7 0%, #464775 100%); 
            color: white; 
            padding: 30px; 
            border-radius: 8px; 
            margin-bottom: 30px; 
            text-align: center;
        }
        .header h1 { margin: 0; font-size: 28px; }
        .header .subtitle { margin: 10px 0 0 0; font-size: 16px; opacity: 0.9; }
        .summary-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .summary-card { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            text-align: center; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .summary-card h3 { margin: 0 0 10px 0; color: #666; font-size: 14px; }
        .summary-card .value { font-size: 36px; font-weight: bold; margin: 10px 0; }
        .summary-card .description { font-size: 12px; color: #888; }
        .value.success { color: #107c10; }
        .value.warning { color: #ff8c00; }
        .value.danger { color: #d13438; }
        .value.info { color: #6264a7; }
        .governance-meter {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .meter-container {
            position: relative;
            height: 40px;
            margin: 20px 0;
        }
        .governance-bar {
            width: 100%;
            height: 40px;
            background-color: #e1e1e1;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }
        .governance-fill {
            height: 100%;
            background: linear-gradient(90deg, #d13438 0%, #ff8c00 30%, #ffc107 60%, #107c10 80%);
            border-radius: 20px;
            transition: width 0.3s ease;
        }
        .meter-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        .section {
            background: white;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section-header {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
        }
        .section-content { padding: 20px; }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            margin: 20px 0;
        }
        .data-table th {
            background-color: #6264a7;
            color: white;
            border: 1px solid #ddd;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
        }
        .data-table td {
            border: 1px solid #ddd;
            padding: 8px;
            font-size: 12px;
        }
        .data-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .data-table tr:hover {
            background-color: #e9ecef;
        }
        .risk-critical { background-color: #f8d7da !important; color: #721c24; font-weight: bold; }
        .risk-warning { background-color: #fff3cd !important; color: #856404; font-weight: bold; }
        .risk-attention { background-color: #cce5f0 !important; color: #0c5460; }
        .risk-normal { background-color: #d4edda !important; color: #155724; }
        .risk-info { background-color: #d1ecf1 !important; color: #0c5460; }
        .governance-good { color: #107c10; font-weight: bold; }
        .governance-attention { color: #fd7e14; font-weight: bold; }
        .governance-poor { color: #d13438; font-weight: bold; }
        .scrollable-table {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .alert-box {
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .alert-critical {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }
        .alert-info {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        .recommendation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .recommendation-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #6264a7;
        }
        .recommendation-card.critical { border-left-color: #d13438; }
        .recommendation-card.warning { border-left-color: #ff8c00; }
        .recommendation-card.info { border-left-color: #0078d4; }
        .footer { 
            text-align: center; 
            color: #666; 
            font-size: 12px; 
            margin-top: 30px; 
            padding: 20px;
        }
        @media print {
            body { background-color: white; }
            .summary-grid { grid-template-columns: repeat(4, 1fr); }
            .scrollable-table { overflow-x: visible; }
            .data-table { font-size: 10px; }
            .data-table th, .data-table td { padding: 4px; }
        }
        @media (max-width: 768px) {
            .summary-grid { grid-template-columns: repeat(2, 1fr); }
            .recommendation-grid { grid-template-columns: 1fr; }
            .data-table { font-size: 12px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>📋 Microsoft Teams構成分析ダッシュボード</h1>
        <div class="subtitle">みらい建設工業株式会社 - Teams ガバナンス監視</div>
        <div class="subtitle">レポート生成日時: 2025年06月12日 21:44:22</div>
    </div>

    <div class="summary-grid">
        <div class="summary-card">
            <h3>総チーム数</h3>
            <div class="value info">10</div>
            <div class="description">登録チーム</div>
        </div>
        <div class="summary-card">
            <h3>アクティブチーム</h3>
            <div class="value success">9</div>
            <div class="description">利用中</div>
        </div>
        <div class="summary-card">
            <h3>オーナー不在</h3>
            <div class="value danger">10</div>
            <div class="description">緊急対応必要</div>
        </div>
        <div class="summary-card">
            <h3>単一オーナー</h3>
            <div class="value success">0</div>
            <div class="description">冗長性要改善</div>
        </div>
        <div class="summary-card">
            <h3>ゲスト参加</h3>
            <div class="value success">0</div>
            <div class="description">セキュリティ確認</div>
        </div>
        <div class="summary-card">
            <h3>要対応チーム</h3>
            <div class="value warning">9</div>
            <div class="description">管理要注意</div>
        </div>
        <div class="summary-card">
            <h3>総メンバー数</h3>
            <div class="value info">0</div>
            <div class="description">全チーム合計</div>
        </div>
        <div class="summary-card">
            <h3>総チャンネル数</h3>
            <div class="value info">0</div>
            <div class="description">情報交換拠点</div>
        </div>
    </div>

    <div class="governance-meter">
        <h3>📊 Teams ガバナンススコア</h3>
        <div class="governance-bar">
            <div class="governance-fill" style="width: 0%"></div>
            <div class="meter-label">ガバナンス健全性: 0%</div>
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666;">
            <span>🔴 要改善 (0-40%)</span>
            <span>🟡 注意 (40-70%)</span>
            <span>🟢 良好 (70-100%)</span>
        </div>
        <div style="margin-top: 15px; text-align: center;">
            <p><strong>レコーディングポリシー準拠率:</strong> 100%</p>
            <p><strong>平均メンバー数/チーム:</strong> </p>
            <p><strong>平均チャンネル数/チーム:</strong> </p>
        </div>
    </div>

    <div class="alert-box alert-critical">
            <strong>🚨 緊急対応が必要:</strong> 10個のチームにオーナーが存在しません。業務継続に支障をきたす可能性があります。
        </div>

    <div class="section">
        <div class="section-header">📋 詳細チーム構成データ</div>
        <div class="section-content">
            <div class="scrollable-table">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>チーム名</th>
                            <th>プライバシー</th>
                            <th>メンバー数</th>
                            <th>オーナー数</th>
                            <th>ゲスト数</th>
                            <th>チャンネル数</th>
                            <th>最終活動</th>
                            <th>録画設定</th>
                            <th>リスクレベル</th>
                            <th>ガバナンス</th>
                            <th>推奨事項</th>
                        </tr>
                    </thead>
                    <tbody>                        <tr class="risk-warning">
                            <td><strong>プロジェクト管理チーム</strong></td>
                            <td style="text-align: center;">Public</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">3-6ヶ月前</td>
                            <td style="text-align: center;">許可</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>開発チーム</strong></td>
                            <td style="text-align: center;">Private</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">6ヶ月以上前</td>
                            <td style="text-align: center;">許可</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください; 長期間非アクティブ - 利用状況を確認してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>営業部</strong></td>
                            <td style="text-align: center;">Private</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">6ヶ月以上前</td>
                            <td style="text-align: center;">禁止</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください; 長期間非アクティブ - 利用状況を確認してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>マーケティング部</strong></td>
                            <td style="text-align: center;">Public</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">3-6ヶ月前</td>
                            <td style="text-align: center;">禁止</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>人事部</strong></td>
                            <td style="text-align: center;">Private</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">3-6ヶ月前</td>
                            <td style="text-align: center;">許可</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>経理部</strong></td>
                            <td style="text-align: center;">Private</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">1-3ヶ月前</td>
                            <td style="text-align: center;">禁止</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>IT運用チーム</strong></td>
                            <td style="text-align: center;">Public</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">1-3ヶ月前</td>
                            <td style="text-align: center;">許可</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>カスタマーサポート</strong></td>
                            <td style="text-align: center;">Private</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">6ヶ月以上前</td>
                            <td style="text-align: center;">制限</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください; 長期間非アクティブ - 利用状況を確認してください</td>
                        </tr>                        <tr class="risk-warning">
                            <td><strong>品質管理部</strong></td>
                            <td style="text-align: center;">Private</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">3-6ヶ月前</td>
                            <td style="text-align: center;">制限</td>
                            <td class="risk-warning" style="text-align: center;">警告</td>
                            <td class="governance-good" style="text-align: center;">要確認</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください</td>
                        </tr>                        <tr class="risk-info">
                            <td><strong>戦略企画室</strong></td>
                            <td style="text-align: center;">Public</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: right;">0</td>
                            <td style="text-align: center;">6ヶ月以上前</td>
                            <td style="text-align: center;">禁止</td>
                            <td class="risk-info" style="text-align: center;">情報</td>
                            <td class="governance-good" style="text-align: center;">アーカイブ済</td>
                            <td>オーナーが存在しません - 管理者を指定してください; メンバーが存在しません - 削除を検討してください; アーカイブ済チーム; 長期間非アクティブ - 利用状況を確認してください</td>
                        </tr>                    </tbody>
                </table>
            </div>
            <div style="margin-top: 15px; font-size: 12px; color: #6c757d;">
                ※ データはCSVファイルと完全に同期しています。<br>
                ※ オーナー不在チームは緊急対応、単一オーナーチームは冗長性確保を推奨します。
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header">💡 Teams ガバナンス最適化提案</div>
        <div class="section-content">
            <div class="recommendation-grid">
                <div class="recommendation-card critical">
                        <h4>🚨 オーナー不在チーム対応</h4>
                        <p><strong>対象:</strong> 10個のチーム</p>
                        <p><strong>対応策:</strong></p>
                        <ul>
                            <li>適切な管理者をオーナーに指定</li>
                            <li>チーム利用状況の確認</li>
                            <li>不要な場合はアーカイブまたは削除</li>
                        </ul>
                    </div>
                
                
                
                
                
                <div class="recommendation-card info">
                    <h4>📊 定期メンテナンス</h4>
                    <p><strong>推奨頻度:</strong> 月次実行</p>
                    <p><strong>チェック項目:</strong></p>
                    <ul>
                        <li>チーム利用状況の確認</li>
                        <li>不要チームのアーカイブ</li>
                        <li>ガバナンスポリシーの確認</li>
                        <li>レコーディング設定の監査</li>
                    </ul>
                </div>
            </div>
            
            <h4>Teams 運用ベストプラクティス:</h4>
            <ul>
                <li><strong>オーナーシップ:</strong> 各チームに最低2名のオーナーを配置</li>
                <li><strong>命名規則:</strong> 一貫した命名規則でチーム管理を効率化</li>
                <li><strong>アクセス制御:</strong> 機密情報を扱うチームはプライベート設定</li>
                <li><strong>定期レビュー:</strong> 四半期ごとのメンバーシップとアクセス権確認</li>
                <li><strong>アーカイブ:</strong> 非アクティブチームの適切なアーカイブ実施</li>
            </ul>
            
            <h4>セキュリティ・コンプライアンス:</h4>
            <ul>
                <li><strong>情報分類:</strong> チームごとの情報分類レベル設定</li>
                <li><strong>レコーディング:</strong> 会議録画の保持期間とアクセス制御</li>
                <li><strong>外部共有:</strong> ゲストアクセスの承認フローと監査</li>
                <li><strong>データ保護:</strong> 機密データの適切な保護措置</li>
            </ul>
        </div>
    </div>

    <div class="footer">
        <p>このレポートは Microsoft 365 統合管理システムにより自動生成されました</p>
        <p>ITSM/ISO27001/27002準拠 | みらい建設工業株式会社 Teams ガバナンス管理センター</p>
        <p>🤖 Generated with Claude Code</p>
    </div>
</body>
</html>
